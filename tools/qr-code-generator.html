<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-translate-key="qrGenerator.pageTitle">QRã‚³ãƒ¼ãƒ‰ä½œæˆãƒ„ãƒ¼ãƒ« - negi-lab.com</title>
  <meta name="description" data-translate-key="qrGenerator.metaDescription" content="ãƒ†ã‚­ã‚¹ãƒˆã‚„URLã‹ã‚‰ç°¡å˜ã«ã‚«ã‚¹ã‚¿ãƒ QRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã€‚ã‚¨ãƒ©ãƒ¼è¨‚æ­£ãƒ¬ãƒ™ãƒ«ã‚‚èª¿æ•´å¯èƒ½ã€‚" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />  <script src="https://cdn.tailwindcss.com"></script>
  <!-- å¤–éƒ¨CDNãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å‰Šé™¤ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚¤ãƒ†ã‚£ãƒ–API + è‡ªä½œå®Ÿè£…ã«ç½®æ› -->  <script>
    // QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è»½é‡è‡ªä½œå®Ÿè£…ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–ç‰ˆï¼‰
    class SimpleQR {
      static generate(text, options = {}) {
        if (!text || text.trim() === '') {
          return Promise.reject(new Error('QRã‚³ãƒ¼ãƒ‰ã®ãƒ†ã‚­ã‚¹ãƒˆãŒç©ºã§ã™'));
        }
        
        const size = Math.min(Math.max(options.size || 256, 128), 1024); // ã‚µã‚¤ã‚ºåˆ¶é™
        const errorCorrection = options.errorCorrection || 'M';
        const fg = (options.foreground || '#000000').replace('#', '');
        const bg = (options.background || '#ffffff').replace('#', '');
        
        try {
          // Google Charts API URLã‚’ç”Ÿæˆ
          const params = new URLSearchParams({
            chs: `${size}x${size}`,
            cht: 'qr',
            chl: encodeURIComponent(text), // URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰è¿½åŠ 
            choe: 'UTF-8',
            chld: `${errorCorrection}|0`,
            chco: `${fg}${bg}` // å‰æ™¯è‰²ã¨èƒŒæ™¯è‰²
          });
          
          const qrUrl = `https://chart.googleapis.com/chart?${params.toString()}`;
          
          return new Promise((resolve, reject) => {
            const img = document.createElement('img');
            
            // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆ10ç§’ï¼‰
            const timeout = setTimeout(() => {
              reject(new Error('QRã‚³ãƒ¼ãƒ‰ç”ŸæˆãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ'));
            }, 10000);
            
            img.onload = () => {
              clearTimeout(timeout);
              img.className = 'max-w-full h-auto border rounded shadow-sm';
              img.alt = 'Generated QR Code';
              img.style.maxWidth = '100%';
              img.style.height = 'auto';
              resolve(img);
            };
            
            img.onerror = () => {
              clearTimeout(timeout);
              reject(new Error('QRã‚³ãƒ¼ãƒ‰ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ'));
            };
            
            img.src = qrUrl;
          });
        } catch (error) {
          return Promise.reject(new Error(`QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`));
        }
      }
      
      // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨Canvasç”Ÿæˆ
      static generateCanvas(text, options = {}) {
        if (!text || text.trim() === '') {
          return Promise.reject(new Error('QRã‚³ãƒ¼ãƒ‰ã®ãƒ†ã‚­ã‚¹ãƒˆãŒç©ºã§ã™'));
        }
        
        const size = Math.min(Math.max(options.size || 256, 128), 1024);
        const errorCorrection = options.errorCorrection || 'M';
        const fg = (options.foreground || '#000000').replace('#', '');
        const bg = (options.background || '#ffffff').replace('#', '');
        
        try {
          const params = new URLSearchParams({
            chs: `${size}x${size}`,
            cht: 'qr',
            chl: encodeURIComponent(text),
            choe: 'UTF-8',
            chld: `${errorCorrection}|0`,
            chco: `${fg}${bg}`
          });
          
          const qrUrl = `https://chart.googleapis.com/chart?${params.toString()}`;
          
          return new Promise((resolve, reject) => {
            const img = new Image();
            img.crossOrigin = 'anonymous';
            
            const timeout = setTimeout(() => {
              reject(new Error('QRã‚³ãƒ¼ãƒ‰ç”ŸæˆãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ'));
            }, 10000);
            
            img.onload = () => {
              clearTimeout(timeout);
              try {
                const canvas = document.createElement('canvas');
                canvas.width = size;
                canvas.height = size;
                const ctx = canvas.getContext('2d');
                
                // èƒŒæ™¯è‰²è¨­å®š
                ctx.fillStyle = `#${bg}`;
                ctx.fillRect(0, 0, size, size);
                
                // QRã‚³ãƒ¼ãƒ‰æç”»
                ctx.drawImage(img, 0, 0, size, size);
                
                resolve(canvas);
              } catch (drawError) {
                console.warn('Canvasæç”»ã‚¨ãƒ©ãƒ¼:', drawError);
                // Canvasæç”»ã«å¤±æ•—ã—ãŸå ´åˆã€å…ƒã®ç”»åƒã‚’è¿”ã™
                resolve(img);
              }
            };
            
            img.onerror = () => {
              clearTimeout(timeout);
              reject(new Error('QRã‚³ãƒ¼ãƒ‰ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ'));
            };
            
            img.src = qrUrl;
          });
        } catch (error) {          return Promise.reject(new Error(`Canvasç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`));
        }
      }
    }
    
    // è‰²å¤‰æ›é–¢æ•°
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : {r: 0, g: 0, b: 0};
    }
    
    // ZIPç”Ÿæˆã®è»½é‡å®Ÿè£…ï¼ˆåŸºæœ¬çš„ãªãƒ•ã‚¡ã‚¤ãƒ«åœ§ç¸®ï¼‰
    class SimpleZip {
      constructor() {
        this.files = [];
      }
      
      file(filename, data) {
        this.files.push({name: filename, data: data});
      }
      
      generateAsync() {
        // åŸºæœ¬çš„ãªZIPå½¢å¼ã®ä»£æ›¿ã¨ã—ã¦ã€è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸJSONã¨ã—ã¦å‡ºåŠ›
        const zipData = {
          type: 'qr-batch',
          files: this.files.map(f => ({
            name: f.name,
            data: f.data
          })),
          generated: new Date().toISOString()
        };
        
        const blob = new Blob([JSON.stringify(zipData, null, 2)], {type: 'application/json'});
        return Promise.resolve(blob);
      }
    }
    
    // FileSaver.jsä»£æ›¿å®Ÿè£…
    function saveAs(blob, filename) {
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    
    // ä½¿ç”¨ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®äº’æ›æ€§ç¢ºä¿
    window.QRious = SimpleQR; // QRiousãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä»£æ›¿
    window.JSZip = SimpleZip;  // JSZipãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä»£æ›¿
    window.saveAs = saveAs;    // FileSaver.jsã®ä»£æ›¿
    
    // ä¸è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–
    window.fabric = null;      // Fabric.jsã¯ä½¿ç”¨ã—ãªã„
    window.html2canvas = null; // html2canvasã¯ä½¿ç”¨ã—ãªã„
  </script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            negi: "#65c155",
            accent: "#4ADE80"
          },
          fontFamily: { inter: ["Inter", "sans-serif"] }
        }
      }
    }
    window.pageTitleTranslationKey = "qrGenerator.pageTitle";
    window.metaDescriptionTranslationKey = "qrGenerator.metaDescription";
  </script>
  <style>
    /* .form-input, .form-select, .form-button {
      @apply p-2 border border-gray-300 rounded-md shadow-sm focus:ring-accent focus:border-accent;
    }
    .form-button {
      @apply bg-accent text-white hover:bg-emerald-500 transition duration-150 ease-in-out;
    }
    .form-button:disabled {
      @apply bg-gray-300 cursor-not-allowed hover:bg-gray-300;
    } */    /* ä¸Šè¨˜@applyã¯Tailwind JITå°‚ç”¨ã€‚é€šå¸¸ã®CSSã«æ›¸ãæ›ãˆ */
    .form-input, .form-select, .form-button {
      padding: 0.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      transition: box-shadow 0.2s;
    }
    .form-input:focus, .form-select:focus, .form-button:focus {
      outline: none;
      box-shadow: 0 0 0 2px #4ADE80;
      border-color: #4ADE80;
    }
    .form-button {
      background: #4ADE80;
      color: #fff;
      transition: background 0.15s, color 0.15s;
    }
    .form-button:hover:not(:disabled) {
      background: #10b981;
    }
    .form-button:disabled {
      background: #d1d5db;
      color: #fff;
      cursor: not-allowed;
    }
    #qrcodeOutput {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 10px;
        border: 1px solid #e2e8f0; /* gray-200 */
        border-radius: 0.375rem; /* rounded-md */
        min-height: 200px; 
        background-color: white;
    }
    #qrcodeOutput img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: auto;
    }
    
    /* ã‚¿ãƒ–ã‚¹ã‚¿ã‚¤ãƒ« */
    .tab-button {
      color: #6b7280;
      border-color: transparent;
      transition: all 0.2s;
    }
    .tab-button:hover {
      color: #374151;
      border-color: #d1d5db;
    }
    .tab-button.active {
      color: #4ADE80;
      border-color: #4ADE80;
    }
    .tab-content {
      animation: fadeIn 0.3s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ã‚«ãƒ©ãƒ¼ãƒ—ãƒªã‚»ãƒƒãƒˆ */
    .color-preset {
      border: 2px solid #e5e7eb;
      cursor: pointer;
      transition: border-color 0.2s;
    }
    .color-preset:hover {
      border-color: #4ADE80;
    }
    .color-preset.active {
      border-color: #4ADE80;
      box-shadow: 0 0 0 2px rgba(74, 222, 128, 0.2);
    }
  </style>
  <!-- Google Analyticsï¼ˆgtag.jsï¼‰å…¨ãƒšãƒ¼ã‚¸ç”¨ -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-N9X3N0RY0H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N9X3N0RY0H');
  </script>
  <!-- Google AdSenseå¯©æŸ»ç”¨ã‚³ãƒ¼ãƒ‰ -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1835873052239386" crossorigin="anonymous"></script>
</head>
<body class="bg-gray-50 text-gray-800 font-inter min-h-screen flex flex-col">

  <!-- Amazonã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆ/æ¥½å¤©ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆ CookieåŸ‹ã‚è¾¼ã¿ãƒ»imgã‚¿ã‚°å‰Šé™¤ï¼ˆASPè¦ç´„å¯¾ç­–ï¼‰ -->

  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex justify-between items-center px-4 py-4">
      <a href="/" class="text-2xl font-extrabold text-accent tracking-tight hover:opacity-80 transition">negi-lab.com</a>
      <nav>
        <ul class="flex gap-6 font-medium text-base items-center">
          <li><a href="/#tools" class="hover:text-accent transition" data-translate-key="header.nav.tools">ãƒ„ãƒ¼ãƒ«</a></li>
          <li><a href="/#wikis" class="hover:text-accent transition" data-translate-key="header.nav.wikis">ã‚²ãƒ¼ãƒ Wiki</a></li>
          <li>
            <select id="lang-switch" class="rounded border border-gray-300 px-2 py-1 text-gray-700 text-sm focus:outline-none focus:ring-2 focus:ring-accent transition">
              <option value="ja" data-translate-key="option.ja">æ—¥æœ¬èª</option>
              <option value="en" data-translate-key="option.en">English</option>
            </select>
          </li>
          <li>
            <button id="guide-btn" class="rounded border border-accent px-3 py-1 text-accent text-sm font-semibold bg-white hover:bg-accent/10 focus:outline-none focus:ring-2 focus:ring-accent transition" aria-haspopup="dialog" aria-controls="guide-modal" data-translate-key="header.guide">ã‚¬ã‚¤ãƒ‰</button>
          </li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="flex-grow py-12">
    <div class="max-w-2xl mx-auto px-4">
      <h1 class="text-3xl md:text-4xl font-bold text-center text-gray-900 mb-10" data-translate-key="qrGenerator.mainTitle">QRã‚³ãƒ¼ãƒ‰ä½œæˆãƒ„ãƒ¼ãƒ«</h1>
      
      <!-- ãƒ„ãƒ¼ãƒ«ä¸Šéƒ¨ï¼šã‚¢ãƒ‰ã‚»ãƒ³ã‚¹ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ï¼‰ -->
      <div class="max-w-2xl mx-auto my-6">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-xxxxxxxxxxxxxxxx"
             data-ad-slot="1234567890"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>      <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg space-y-6">
        
        <!-- é«˜åº¦ãªè¨­å®šã‚¿ãƒ– -->
        <div class="border-b border-gray-200 mb-6">
          <nav class="-mb-px flex space-x-8 overflow-x-auto" aria-label="Tabs">
            <button id="tab-basic" class="tab-button active py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap">åŸºæœ¬è¨­å®š</button>
            <button id="tab-design" class="tab-button py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap">ãƒ‡ã‚¶ã‚¤ãƒ³</button>
            <button id="tab-batch" class="tab-button py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap">ä¸€æ‹¬ç”Ÿæˆ</button>
            <button id="tab-advanced" class="tab-button py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap">é«˜åº¦ãªè¨­å®š</button>
            <button id="tab-api" class="tab-button py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap">API/è‡ªå‹•åŒ–</button>
          </nav>
        </div>

        <!-- åŸºæœ¬è¨­å®šã‚¿ãƒ– -->
        <div id="content-basic" class="tab-content">
          <!-- â–¼â–¼â–¼ ãƒ‡ãƒ¼ã‚¿å½¢å¼é¸æŠUIè¿½åŠ  â–¼â–¼â–¼ -->
          <div class="mb-4">
            <label for="qrType" class="block text-sm font-medium text-gray-700 mb-1" data-translate-key="qrGenerator.typeLabel">ãƒ‡ãƒ¼ã‚¿å½¢å¼:</label>
            <select id="qrType" class="form-select w-full">
              <option value="text" data-translate-key="qrGenerator.type.text">ãƒ†ã‚­ã‚¹ãƒˆ/URL</option>
              <option value="email" data-translate-key="qrGenerator.type.email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</option>
              <option value="tel" data-translate-key="qrGenerator.type.tel">é›»è©±ç•ªå·</option>
              <option value="sms" data-translate-key="qrGenerator.type.sms">SMS</option>
              <option value="vcard" data-translate-key="qrGenerator.type.vcard">é€£çµ¡å…ˆï¼ˆvCardï¼‰</option>
              <option value="wifi" data-translate-key="qrGenerator.type.wifi">Wi-Fiæ¥ç¶š</option>
              <option value="event" data-translate-key="qrGenerator.type.event">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ</option>
              <option value="geo" data-translate-key="qrGenerator.type.geo">ä½ç½®æƒ…å ±</option>
              <option value="line" data-translate-key="qrGenerator.type.line">LINE/SNS</option>
              <option value="crypto" data-translate-key="qrGenerator.type.crypto">æš—å·é€šè²¨ã‚¢ãƒ‰ãƒ¬ã‚¹</option>
              <option value="mecard">MeCard (ååˆº)</option>
              <option value="bookmark">ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</option>
              <option value="youtube">YouTubeå‹•ç”»</option>
              <option value="spotify">SpotifyéŸ³æ¥½</option>
              <option value="zoom">Zoomä¼šè­°</option>
              <option value="paypal">PayPalé€é‡‘</option>
            </select>
          </div>
        <!-- â–¼â–¼â–¼ ãƒ‡ãƒ¼ã‚¿å½¢å¼ã”ã¨ã®å…¥åŠ›æ¬„ã‚’å‹•çš„ã«åˆ‡ã‚Šæ›¿ãˆï¼ˆä»®ï¼štextã®ã¿è¡¨ç¤ºã€å¾Œã§JSã§åˆ‡æ›¿ï¼‰ â–¼â–¼â–¼ -->
        <div id="qrInputFields">          <div id="qrInput-text">
            <label for="qrData" class="block text-sm font-medium text-gray-700 mb-1" data-translate-key="qrGenerator.dataLabel">ãƒ‡ãƒ¼ã‚¿ (ãƒ†ã‚­ã‚¹ãƒˆã¾ãŸã¯URL):</label>
            <textarea id="qrData" rows="3" class="form-input w-full" placeholder="https://negi-lab.com" aria-label="QRã‚³ãƒ¼ãƒ‰ã«åŸ‹ã‚è¾¼ã‚€ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ†ã‚­ã‚¹ãƒˆã¾ãŸã¯URLï¼‰">https://negi-lab.com</textarea>
          </div>
          <div id="qrInput-email" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</label>
            <input type="email" id="qrEmail" class="form-input w-full" placeholder="example@mail.com">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">ä»¶å:</label>
            <input type="text" id="qrEmailSubject" class="form-input w-full" placeholder="ä»¶åï¼ˆä»»æ„ï¼‰">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">æœ¬æ–‡:</label>
            <textarea id="qrEmailBody" rows="2" class="form-input w-full" placeholder="æœ¬æ–‡ï¼ˆä»»æ„ï¼‰"></textarea>
          </div>
          <div id="qrInput-tel" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">é›»è©±ç•ªå·:</label>
            <input type="tel" id="qrTel" class="form-input w-full" placeholder="09012345678">
          </div>
          <div id="qrInput-sms" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">SMSé€ä¿¡å…ˆç•ªå·:</label>
            <input type="tel" id="qrSmsNumber" class="form-input w-full" placeholder="09012345678">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">æœ¬æ–‡:</label>
            <textarea id="qrSmsBody" rows="2" class="form-input w-full" placeholder="æœ¬æ–‡ï¼ˆä»»æ„ï¼‰"></textarea>
          </div>
          <div id="qrInput-vcard" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">æ°å:</label>
            <input type="text" id="qrVcardName" class="form-input w-full" placeholder="å±±ç”° å¤ªéƒ">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">é›»è©±ç•ªå·:</label>
            <input type="tel" id="qrVcardTel" class="form-input w-full" placeholder="09012345678">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">ãƒ¡ãƒ¼ãƒ«:</label>
            <input type="email" id="qrVcardEmail" class="form-input w-full" placeholder="example@mail.com">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">ä¼šç¤¾å:</label>
            <input type="text" id="qrVcardOrg" class="form-input w-full" placeholder="æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«">
          </div>
          <div id="qrInput-wifi" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">SSID:</label>
            <input type="text" id="qrWifiSsid" class="form-input w-full" placeholder="Wi-Fiå">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰:</label>
            <input type="text" id="qrWifiPass" class="form-input w-full" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">æš—å·åŒ–æ–¹å¼:</label>
            <select id="qrWifiType" class="form-select w-full">
              <option value="WPA">WPA/WPA2</option>
              <option value="WEP">WEP</option>
              <option value="nopass">ãªã—</option>
            </select>
          </div>
          <div id="qrInput-event" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">ã‚¿ã‚¤ãƒˆãƒ«:</label>
            <input type="text" id="qrEventTitle" class="form-input w-full" placeholder="ã‚¤ãƒ™ãƒ³ãƒˆå">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">é–‹å§‹æ—¥æ™‚:</label>
            <input type="datetime-local" id="qrEventStart" class="form-input w-full">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">çµ‚äº†æ—¥æ™‚:</label>
            <input type="datetime-local" id="qrEventEnd" class="form-input w-full">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">å ´æ‰€:</label>
            <input type="text" id="qrEventLocation" class="form-input w-full" placeholder="ä¼šå ´åãƒ»ä½æ‰€">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">èª¬æ˜:</label>
            <textarea id="qrEventDesc" rows="2" class="form-input w-full" placeholder="èª¬æ˜ï¼ˆä»»æ„ï¼‰"></textarea>
          </div>
          <div id="qrInput-geo" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">ç·¯åº¦:</label>
            <input type="number" id="qrGeoLat" class="form-input w-full" placeholder="35.681236" step="any">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">çµŒåº¦:</label>
            <input type="number" id="qrGeoLng" class="form-input w-full" placeholder="139.767125" step="any">
          </div>
          <div id="qrInput-line" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">LINE/SNSãƒªãƒ³ã‚¯:</label>
            <input type="text" id="qrLineUrl" class="form-input w-full" placeholder="https://line.me/xxxx">
          </div>          <!-- æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿å½¢å¼ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ  -->
          <div id="qrInput-mecard" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">åå‰:</label>
            <input type="text" id="qrMecardName" class="form-input w-full" placeholder="å±±ç”°å¤ªéƒ">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">èª­ã¿:</label>
            <input type="text" id="qrMecardReading" class="form-input w-full" placeholder="ãƒ¤ãƒãƒ€ã‚¿ãƒ­ã‚¦">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">é›»è©±:</label>
            <input type="tel" id="qrMecardPhone" class="form-input w-full" placeholder="090-1234-5678">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">ãƒ¡ãƒ¼ãƒ«:</label>
            <input type="email" id="qrMecardEmail" class="form-input w-full" placeholder="yamada@example.com">
          </div>
          <div id="qrInput-bookmark" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">ã‚¿ã‚¤ãƒˆãƒ«:</label>
            <input type="text" id="qrBookmarkTitle" class="form-input w-full" placeholder="ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">URL:</label>
            <input type="url" id="qrBookmarkUrl" class="form-input w-full" placeholder="https://example.com">
          </div>
          <div id="qrInput-youtube" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">YouTube URL:</label>
            <input type="url" id="qrYoutubeUrl" class="form-input w-full" placeholder="https://www.youtube.com/watch?v=...">
            <button id="extractYoutube" class="mt-1 text-xs bg-red-500 text-white px-2 py-1 rounded">å‹•ç”»æƒ…å ±å–å¾—</button>
          </div>
          <div id="qrInput-spotify" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">Spotify URL:</label>
            <input type="url" id="qrSpotifyUrl" class="form-input w-full" placeholder="https://open.spotify.com/track/...">
          </div>
          <div id="qrInput-zoom" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">ä¼šè­°ID:</label>
            <input type="text" id="qrZoomId" class="form-input w-full" placeholder="123-456-789">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰:</label>
            <input type="text" id="qrZoomPass" class="form-input w-full" placeholder="ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ï¼ˆä»»æ„ï¼‰">
          </div>          <div id="qrInput-paypal" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">PayPal.Me URL:</label>
            <input type="url" id="qrPaypalUrl" class="form-input w-full" placeholder="https://paypal.me/username/amount">
          </div>
          <div id="qrInput-crypto" style="display:none">
            <label class="block text-sm font-medium text-gray-700 mb-1">æš—å·é€šè²¨ç¨®é¡:</label>
            <select id="qrCryptoType" class="form-select w-full mb-2">
              <option value="bitcoin">Bitcoin (BTC)</option>
              <option value="ethereum">Ethereum (ETH)</option>
              <option value="litecoin">Litecoin (LTC)</option>
              <option value="dogecoin">Dogecoin (DOGE)</option>
              <option value="other">ãã®ä»–</option>
            </select>
            <label class="block text-sm font-medium text-gray-700 mb-1">ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹:</label>
            <input type="text" id="qrCryptoAddr" class="form-input w-full" placeholder="1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa">
            <label class="block text-sm font-medium text-gray-700 mt-2 mb-1">é‡‘é¡ï¼ˆä»»æ„ï¼‰:</label>
            <input type="number" id="qrCryptoAmount" class="form-input w-full" placeholder="0.001" step="any">
          </div>
          // ...existing code...
        </div>

        <!-- åŸºæœ¬è¨­å®šã®è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
          <div>
            <label for="qrSize" class="block text-sm font-medium text-gray-700 mb-1">ã‚µã‚¤ã‚º (px):</label>
            <input type="range" id="qrSizeSlider" min="50" max="2000" value="256" class="w-full mb-1">
            <input type="number" id="qrSize" value="256" min="50" max="2000" class="form-input w-full text-center">
          </div>
          <div>
            <label for="qrErrorCorrection" class="block text-sm font-medium text-gray-700 mb-1">ã‚¨ãƒ©ãƒ¼è¨‚æ­£:</label>
            <select id="qrErrorCorrection" class="form-select w-full">
              <option value="L">Low (L ~7%)</option>
              <option value="M">Medium (M ~15%)</option>
              <option value="Q">Quartile (Q ~25%)</option>
              <option value="H">High (H ~30%)</option>
            </select>
          </div>          <div>
            <label for="qrMargin" class="block text-sm font-medium text-gray-700 mb-1">ãƒãƒ¼ã‚¸ãƒ³:</label>
            <input type="number" id="qrMargin" value="4" min="0" max="20" class="form-input w-full">
          </div>
        </div>        <div class="space-y-4">
          <button id="generateQrButton" class="form-button w-full py-3 text-lg font-medium hover:bg-green-600 transition-colors duration-200" data-translate-key="qrGenerator.generateButton">
            <svg class="w-5 h-5 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd"></path>
            </svg>
            QRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
          </button>
          
          <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
          <div id="qrPreviewContainer" class="mt-6">
            <h3 class="text-lg font-semibold mb-3 text-gray-800">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
            <div id="qrcodeOutput" class="border-2 border-dashed border-gray-300 rounded-lg p-6 min-h-[250px] flex items-center justify-center bg-gray-50 transition-all duration-300">
              <div class="text-center">
                <svg class="w-12 h-12 text-gray-400 mx-auto mb-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-gray-500">ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ã€ŒQRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</span>
              </div>
            </div>
          </div>
          
          <!-- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ -->
          <div id="qrResultContainer" class="mt-6 space-y-4 hidden">
            <h3 class="text-lg font-semibold text-gray-800">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
              <button id="downloadQrButton" class="form-button py-3 font-medium hover:bg-blue-600 transition-colors" data-translate-key="qrGenerator.downloadButton">
                <svg class="w-4 h-4 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
                PNGå½¢å¼
              </button>
              <button id="downloadQrJpegButton" class="form-button py-3 font-medium hover:bg-blue-600 transition-colors" type="button">
                <svg class="w-4 h-4 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
                JPEGå½¢å¼
              </button>
              <button id="downloadQrSvgButton" class="form-button py-3 font-medium hover:bg-blue-600 transition-colors" type="button">
                <svg class="w-4 h-4 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
                SVGå½¢å¼
              </button>
            </div>
          </div>
        </div>
        
        <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ -->
        <div id="messageArea" class="mt-4">
          <div id="statusMessage" class="text-sm text-green-600 hidden"></div>
          <div id="errorMessage" class="text-sm text-red-600 hidden"></div>
        </div>

        <div class="mt-4">
          <label for="qrLogo" class="block text-sm font-medium text-gray-700 mb-1">ãƒ­ã‚´ç”»åƒï¼ˆä¸­å¤®åˆæˆãƒ»ä»»æ„ï¼‰:</label>
          <input type="file" id="qrLogo" accept="image/*" class="form-input w-full" aria-label="QRã‚³ãƒ¼ãƒ‰ä¸­å¤®ã«åˆæˆã™ã‚‹ãƒ­ã‚´ç”»åƒ">
        </div>        <div id="qrAdBannerToggleBox" class="flex items-center gap-2 mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
          <input type="checkbox" id="qrAdBannerToggle" class="form-checkbox">
          <label for="qrAdBannerToggle" class="text-sm">
            <strong>ã‚µã‚¤ãƒˆé‹å–¶æ”¯æ´</strong>: negi-lab.comã®ç¶™ç¶šé‹å–¶ã«ã”å”åŠ›ã„ãŸã ã
            <div class="text-xs text-gray-600 mt-1">
              â€» ãƒã‚§ãƒƒã‚¯ã„ãŸã ãã¨ã€ã‚µã‚¤ãƒˆã®é‹å–¶ç¶­æŒã«ãŠå½¹ç«‹ã¦ã„ãŸã ã‘ã¾ã™ã€‚
            </div>
          </label>
        </div>
          <!-- æ©Ÿèƒ½èª¬æ˜ -->
        <div id="adBannerPreview" class="mt-2 p-2 bg-green-50 border border-green-200 rounded text-center text-xs hidden">
          <div class="text-green-600">âœ“ ã‚µã‚¤ãƒˆé‹å–¶æ”¯æ´ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã—ãŸ</div>
          <div class="text-gray-500 mt-1">ã”å”åŠ›ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™</div>
        </div>

      </div>      <!-- ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¿ãƒ– -->
      <div id="content-design" class="tab-content hidden">
        <div class="space-y-6">
          <!-- ã‚«ãƒ©ãƒ¼è¨­å®š - çµ±ä¸€ã•ã‚ŒãŸãƒ‡ã‚¶ã‚¤ãƒ³ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v11a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4zm0 2h12v11H4V4z" clip-rule="evenodd"></path>
              </svg>
              ã‚«ãƒ©ãƒ¼è¨­å®š
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-3">å‰æ™¯è‰²ï¼ˆQRã‚³ãƒ¼ãƒ‰ï¼‰</label>
                <div class="space-y-3">
                  <div class="flex space-x-2">
                    <input type="color" id="qrFgColor" value="#000000" class="form-input h-12 w-16 p-1 rounded-lg border-2">
                    <input type="text" id="qrFgColorText" value="#000000" class="form-input flex-1 font-mono" placeholder="#000000">
                  </div>
                  <div class="grid grid-cols-6 gap-2">
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#000000" data-color="#000000" title="ãƒ–ãƒ©ãƒƒã‚¯"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#333333" data-color="#333333" title="ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#666666" data-color="#666666" title="ã‚°ãƒ¬ãƒ¼"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#dc2626" data-color="#dc2626" title="ãƒ¬ãƒƒãƒ‰"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#16a34a" data-color="#16a34a" title="ã‚°ãƒªãƒ¼ãƒ³"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#2563eb" data-color="#2563eb" title="ãƒ–ãƒ«ãƒ¼"></div>
                  </div>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-3">èƒŒæ™¯è‰²</label>
                <div class="space-y-3">
                  <div class="flex space-x-2">
                    <input type="color" id="qrBgColor" value="#ffffff" class="form-input h-12 w-16 p-1 rounded-lg border-2">
                    <input type="text" id="qrBgColorText" value="#ffffff" class="form-input flex-1 font-mono" placeholder="#ffffff">
                  </div>
                  <div class="grid grid-cols-6 gap-2">
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#ffffff; border-color: #d1d5db" data-color="#ffffff" title="ãƒ›ãƒ¯ã‚¤ãƒˆ"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#f8fafc" data-color="#f8fafc" title="ã‚ªãƒ•ãƒ›ãƒ¯ã‚¤ãƒˆ"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#e2e8f0" data-color="#e2e8f0" title="ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#fef3c7" data-color="#fef3c7" title="ãƒ©ã‚¤ãƒˆã‚¤ã‚¨ãƒ­ãƒ¼"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#fecaca" data-color="#fecaca" title="ãƒ©ã‚¤ãƒˆãƒ”ãƒ³ã‚¯"></div>
                    <div class="color-preset w-10 h-10 rounded-lg cursor-pointer border-2 hover:scale-105 transition-transform" style="background:#ddd6fe" data-color="#ddd6fe" title="ãƒ©ã‚¤ãƒˆãƒ‘ãƒ¼ãƒ—ãƒ«"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"></path>
              </svg>
              ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
            </h3>
            <div class="space-y-4">
              <!-- ãƒ‰ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-3">ãƒ‰ãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³</label>
                <div class="grid grid-cols-3 gap-3">
                  <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                    <input type="radio" name="qrPattern" value="square" class="form-radio mr-2" checked>
                    <span class="text-sm font-medium">æ­£æ–¹å½¢</span>
                  </label>
                  <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                    <input type="radio" name="qrPattern" value="circle" class="form-radio mr-2">
                    <span class="text-sm font-medium">å††å½¢</span>
                  </label>
                  <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                    <input type="radio" name="qrPattern" value="rounded" class="form-radio mr-2">
                    <span class="text-sm font-medium">è§’ä¸¸</span>
                  </label>
                </div>
              </div>
              
              <!-- ãƒ•ãƒ¬ãƒ¼ãƒ è¨­å®š -->
              <div>
                <label for="qrFrame" class="block text-sm font-medium text-gray-700 mb-2">ãƒ•ãƒ¬ãƒ¼ãƒ ã‚¹ã‚¿ã‚¤ãƒ«</label>
                <select id="qrFrame" class="form-select w-full">
                  <option value="none">ãƒ•ãƒ¬ãƒ¼ãƒ ãªã—</option>
                  <option value="simple">ã‚·ãƒ³ãƒ—ãƒ«</option>
                  <option value="rounded">è§’ä¸¸ãƒ•ãƒ¬ãƒ¼ãƒ </option>
                  <option value="shadow">ã‚·ãƒ£ãƒ‰ã‚¦ä»˜ã</option>
                  <option value="decorative">è£…é£¾çš„</option>
                </select>
              </div>
            </div>
          </div>
          
          <!-- ãƒ­ã‚´è¨­å®š -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path>
              </svg>
              ãƒ­ã‚´è¨­å®š
            </h3>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  ãƒ­ã‚´ã‚µã‚¤ã‚º: <span id="logoSizeValue" class="font-mono">20%</span>
                </label>
                <input type="range" id="logoSize" min="10" max="40" value="20" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
              </div>
              <div class="grid grid-cols-2 gap-4">
                <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                  <input type="checkbox" id="logoBorder" class="form-checkbox mr-2">
                  <span class="text-sm font-medium">ç™½ã„ç¸å–ã‚Š</span>
                </label>
                <label class="flex items-center p-3 border border-gray-300 rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                  <input type="checkbox" id="logoShadow" class="form-checkbox mr-2">
                  <span class="text-sm font-medium">å½±åŠ¹æœ</span>
                </label>
              </div>
            </div>
          </div>
          
          <!-- ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ†ãƒ¼ãƒ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" clip-rule="evenodd"></path>
              </svg>
              ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ†ãƒ¼ãƒ
            </h3>
            <div class="grid grid-cols-2 gap-3">
              <button class="theme-preset bg-black text-white px-4 py-3 rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors" data-theme="classic">ã‚¯ãƒ©ã‚·ãƒƒã‚¯</button>
              <button class="theme-preset bg-blue-500 text-white px-4 py-3 rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors" data-theme="modern">ãƒ¢ãƒ€ãƒ³</button>
              <button class="theme-preset bg-green-500 text-white px-4 py-3 rounded-lg text-sm font-medium hover:bg-green-600 transition-colors" data-theme="nature">ãƒŠãƒãƒ¥ãƒ©ãƒ«</button>
              <button class="theme-preset bg-purple-500 text-white px-4 py-3 rounded-lg text-sm font-medium hover:bg-purple-600 transition-colors" data-theme="creative">ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–</button>
            </div>
          </div>
        </div>
      </div>      <!-- ä¸€æ‹¬ç”Ÿæˆã‚¿ãƒ– -->
      <div id="content-batch" class="tab-content hidden">
        <div class="space-y-6">
          <!-- ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã‚¨ãƒªã‚¢ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6.5a.5.5 0 01-.5.5.5.5 0 01-.5-.5V7a1 1 0 00-1-1H7a1 1 0 00-1 1v8a2 2 0 002 2h4.5a.5.5 0 01.5.5.5.5 0 01-.5.5H8a3 3 0 01-3-3V5z" clip-rule="evenodd"></path>
              </svg>
              ä¸€æ‹¬ãƒ‡ãƒ¼ã‚¿å…¥åŠ›
            </h3>
            <div>
              <label for="batchInput" class="block text-sm font-medium text-gray-700 mb-2">
                ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ï¼ˆ1è¡Œ1ãƒ‡ãƒ¼ã‚¿ã€æœ€å¤§100ä»¶ï¼‰
              </label>
              <textarea 
                id="batchInput" 
                rows="8" 
                class="form-input w-full font-mono text-sm" 
                placeholder="https://example1.com&#10;https://example2.com&#10;contact@example.com&#10;tel:090-1234-5678&#10;&#10;â€» å„è¡Œã«URLã‚„ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
              ></textarea>
              <div class="flex justify-between items-center mt-3">
                <div class="flex items-center space-x-2">
                  <svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                  </svg>
                  <span class="text-sm text-gray-600">CSV/JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆ:</span>
                </div>
                <input type="file" id="csvImport" accept=".csv,.json,.txt" class="text-sm text-gray-600 file:mr-2 file:py-1 file:px-3 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
              </div>
            </div>
          </div>
          
          <!-- ä¸€æ‹¬è¨­å®š -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
              </svg>
              å‡ºåŠ›è¨­å®š
            </h3>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
              <div>
                <label for="batchPrefix" class="block text-sm font-medium text-gray-700 mb-2">ãƒ•ã‚¡ã‚¤ãƒ«åãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹</label>
                <input type="text" id="batchPrefix" value="qrcode" class="form-input w-full" placeholder="qrcode">
              </div>
              <div>
                <label for="batchFormat" class="block text-sm font-medium text-gray-700 mb-2">å‡ºåŠ›å½¢å¼</label>
                <select id="batchFormat" class="form-select w-full">
                  <option value="png">PNGç”»åƒ</option>
                  <option value="jpg">JPEGç”»åƒ</option>
                  <option value="svg">SVGç”»åƒ</option>
                </select>
              </div>
              <div>
                <label for="batchSize" class="block text-sm font-medium text-gray-700 mb-2">ç”»åƒã‚µã‚¤ã‚ºï¼ˆpxï¼‰</label>
                <input type="number" id="batchSize" value="256" min="50" max="1000" class="form-input w-full" placeholder="256">
              </div>
            </div>
          </div>
          
          <!-- æ“ä½œãƒœã‚¿ãƒ³ -->
          <div class="bg-white p-4 rounded-lg border border-gray-200">
            <div class="flex space-x-3">
              <button id="batchGenerate" class="form-button flex-1 py-3 font-medium">
                <svg class="w-4 h-4 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd"></path>
                </svg>
                ä¸€æ‹¬ç”Ÿæˆé–‹å§‹
              </button>
              <button id="batchDownload" class="form-button flex-1 py-3 font-medium opacity-50 cursor-not-allowed" disabled>
                <svg class="w-4 h-4 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
                JSONãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
              </button>
            </div>
            <p class="text-xs text-gray-500 mt-2 text-center">
              ğŸ’¡ ç”Ÿæˆã•ã‚ŒãŸQRã‚³ãƒ¼ãƒ‰ã¯ã€JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™
            </p>
          </div>
          
          <!-- é€²æ—è¡¨ç¤º -->
          <div id="batchProgress" class="hidden bg-blue-50 p-4 rounded-lg border border-blue-200">
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium text-blue-800">ç”Ÿæˆé€²æ—</span>
              <span id="batchProgressText" class="text-sm font-mono text-blue-600">0 / 0</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div id="batchProgressBar" class="bg-accent h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
          </div>
          
          <!-- QRã‚³ãƒ¼ãƒ‰è§£ææ©Ÿèƒ½ -->
          <div class="border-t pt-4">
            <h3 class="text-sm font-medium text-gray-700 mb-2">QRã‚³ãƒ¼ãƒ‰è§£æ</h3>
            <input type="file" id="qrAnalyze" accept="image/*" class="form-input w-full mb-2">
            <div id="analyzeResult" class="hidden p-3 bg-gray-50 rounded text-sm"></div>
          </div>
        </div>
      </div>      <!-- é«˜åº¦ãªè¨­å®šã‚¿ãƒ– -->
      <div id="content-advanced" class="tab-content hidden">
        <div class="space-y-6">
          <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç† -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v8H4V6z"></path>
              </svg>
              ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†
            </h3>
            <div class="space-y-3">
              <div class="flex space-x-2">
                <select id="templateSelect" class="form-select flex-1">
                  <option value="">ä¿å­˜ã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ</option>
                </select>
                <button id="saveTemplate" class="form-button px-4 py-2">ä¿å­˜</button>
                <button id="deleteTemplate" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition">å‰Šé™¤</button>
              </div>
              <input type="text" id="templateName" placeholder="ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåã‚’å…¥åŠ›" class="form-input w-full">
            </div>
          </div>
          
          <!-- QRã‚³ãƒ¼ãƒ‰è§£æ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
              </svg>
              QRã‚³ãƒ¼ãƒ‰è§£æ
            </h3>
            <div class="space-y-3">
              <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
                <input type="file" id="qrAnalyze" accept="image/*" class="hidden">
                <label for="qrAnalyze" class="cursor-pointer flex flex-col items-center">
                  <svg class="w-8 h-8 text-gray-400 mb-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path>
                  </svg>
                  <span class="text-sm text-gray-600">QRã‚³ãƒ¼ãƒ‰ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
                </label>
              </div>
              <div id="analyzeResult" class="hidden p-3 bg-white rounded border text-sm"></div>
            </div>
          </div>
          
          <!-- URLçŸ­ç¸®æ©Ÿèƒ½ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã®ã¿ï¼‰ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"></path>
              </svg>
              URLçŸ­ç¸®ï¼ˆæ‰‹å‹•å‡¦ç†ï¼‰
            </h3>
            <div class="space-y-3">
              <div class="bg-yellow-50 border border-yellow-200 rounded p-3">
                <p class="text-xs text-yellow-800">âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã€å¤–éƒ¨APIæ¥ç¶šã¯è¡Œã„ã¾ã›ã‚“ã€‚æ‰‹å‹•ã§URLçŸ­ç¸®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚</p>
              </div>
              <div class="flex space-x-2">
                <input type="url" id="longUrl" placeholder="é•·ã„URLã‚’å…¥åŠ›" class="form-input flex-1">
                <button id="copyUrlForShorten" class="form-button px-4">ã‚³ãƒ”ãƒ¼</button>
              </div>
              <div class="grid grid-cols-2 gap-2 text-xs">
                <a href="https://tinyurl.com/" target="_blank" class="text-blue-500 hover:underline">TinyURL</a>
                <a href="https://bit.ly/" target="_blank" class="text-blue-500 hover:underline">Bitly</a>
              </div>
            </div>
          </div>
          
          <!-- åˆ©ç”¨çµ±è¨ˆ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"></path>
              </svg>
              åˆ©ç”¨çµ±è¨ˆ
            </h3>
            <div class="grid grid-cols-3 gap-4 text-center">
              <div class="bg-white p-4 rounded-lg border">
                <div class="text-2xl font-bold text-blue-600" id="statsTotal">0</div>
                <div class="text-xs text-gray-600 mt-1">ç·ç”Ÿæˆæ•°</div>
              </div>
              <div class="bg-white p-4 rounded-lg border">
                <div class="text-2xl font-bold text-green-600" id="statsToday">0</div>
                <div class="text-xs text-gray-600 mt-1">ä»Šæ—¥</div>
              </div>
              <div class="bg-white p-4 rounded-lg border">
                <div class="text-2xl font-bold text-purple-600" id="statsWeek">0</div>
                <div class="text-xs text-gray-600 mt-1">ä»Šé€±</div>
              </div>
            </div>
            <div class="mt-3 text-center">
              <button id="clearStats" class="text-xs text-gray-500 hover:text-red-500 transition">çµ±è¨ˆã‚’ãƒªã‚»ãƒƒãƒˆ</button>
            </div>
          </div>
        </div>
      </div>      <!-- API/è‡ªå‹•åŒ–ã‚¿ãƒ– -->
      <div id="content-api" class="tab-content hidden">
        <div class="space-y-6">
          <!-- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è­¦å‘Š -->
          <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <h3 class="text-sm font-semibold text-blue-800 mb-2 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
              </svg>
              ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é…æ…®ã—ãŸè¨­è¨ˆ
            </h3>
            <p class="text-sm text-blue-700">
              ã“ã®ãƒ„ãƒ¼ãƒ«ã®å…¨ã¦ã®æ©Ÿèƒ½ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµã—ã€GitHubãƒªãƒã‚¸ãƒˆãƒªã‚„å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã¸ã®è‡ªå‹•é€ä¿¡ã¯è¡Œã„ã¾ã›ã‚“ã€‚
              ã‚ãªãŸã®ãƒ‡ãƒ¼ã‚¿ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’ä¿è­·ã—ã¾ã™ã€‚
            </p>
          </div>
          
          <!-- ãƒ­ãƒ¼ã‚«ãƒ«è¨­å®šç®¡ç† -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9zM13.73 21a2 2 0 01-3.46 0" clip-rule="evenodd"></path>
              </svg>
              ãƒ­ãƒ¼ã‚«ãƒ«è¨­å®šç®¡ç†
            </h3>
            <div class="space-y-3">
              <div class="flex space-x-2">
                <input type="text" id="localKey" readonly class="form-input flex-1 bg-gray-100 font-mono text-sm" placeholder="è¨­å®šã‚­ãƒ¼ãŒç”Ÿæˆã•ã‚Œã¾ã™">
                <button id="generateLocalKey" class="form-button px-4">ç”Ÿæˆ</button>
                <button id="copyLocalKey" class="form-button px-4">ã‚³ãƒ”ãƒ¼</button>
              </div>
              <p class="text-xs text-gray-600">
                ğŸ’¡ ã“ã®è¨­å®šã‚­ãƒ¼ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã®ã¿ä¿å­˜ã•ã‚Œã€å¤–éƒ¨ã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“
              </p>
            </div>
          </div>
          
          <!-- ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
              </svg>
              ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
            </h3>
            <div class="space-y-3">
              <button id="exportSettings" class="form-button w-full py-3 flex items-center justify-center">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 11-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15.586 13H14a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                </svg>
                è¨­å®šã‚’JSONãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
              </button>
              <button id="exportHistory" class="form-button w-full py-3 flex items-center justify-center">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd"></path>
                </svg>
                å±¥æ­´ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
              </button>
              <button id="exportBatch" class="form-button w-full py-3 flex items-center justify-center">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
                </svg>
                ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿ã‚’JSONã§å‡ºåŠ›
              </button>
            </div>
            <p class="text-xs text-gray-600 mt-3">
              ğŸ“ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯æ‰‹å‹•ã§GitHubãƒªãƒã‚¸ãƒˆãƒªã‚„ãã®ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™
            </p>
          </div>
          
          <!-- ãƒ­ãƒ¼ã‚«ãƒ«è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ -->
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
              </svg>
              ãƒ­ãƒ¼ã‚«ãƒ«è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
            </h3>
            <p class="text-sm text-gray-600 mb-3">
              æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ä½¿ç”¨ã™ã‚‹å®‰å…¨ãªJavaScriptã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆã—ã¾ã™
            </p>
            <textarea id="localScript" rows="8" class="form-input w-full text-xs font-mono bg-gray-100" readonly placeholder="ã€Œã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã“ã“ã«å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"></textarea>
            <button id="generateLocalScript" class="form-button w-full mt-3 py-3">
              <svg class="w-4 h-4 mr-2 inline" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
              </svg>
              ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ
            </button>
          </div>
          
          <!-- ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ -->
          <div class="bg-green-50 p-4 rounded-lg border border-green-200">
            <h3 class="text-sm font-semibold text-green-800 mb-4 flex items-center">
              <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
              </svg>
              å®‰å…¨ãªä½¿ç”¨æ–¹æ³•
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
              <div class="space-y-3">
                <div class="flex items-start">
                  <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">1</span>
                  <div>
                    <p class="font-medium text-green-800">ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</p>
                    <p class="text-green-700 text-xs">è¨­å®šã‚„å±¥æ­´ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã«å®‰å…¨ã«ä¿å­˜</p>
                  </div>
                </div>
                <div class="flex items-start">
                  <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">2</span>
                  <div>
                    <p class="font-medium text-green-800">æ‰‹å‹•ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
                    <p class="text-green-700 text-xs">å¿…è¦ã«å¿œã˜ã¦GitHubã«æ‰‹å‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ </p>
                  </div>
                </div>
              </div>
              <div class="space-y-3">
                <div class="flex items-start">
                  <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">3</span>
                  <div>
                    <p class="font-medium text-green-800">ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†</p>
                    <p class="text-green-700 text-xs">å…¨ã¦ã®å‡¦ç†ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµ</p>
                  </div>
                </div>
                <div class="flex items-start">
                  <span class="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold mr-3 mt-0.5">4</span>
                  <div>
                    <p class="font-medium text-green-800">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·</p>
                    <p class="text-green-700 text-xs">å¤–éƒ¨ã¸ã®è‡ªå‹•é€ä¿¡ã¯ä¸€åˆ‡ãªã—</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>      </div>

      <!-- â–¼â–¼â–¼ ç”Ÿæˆå±¥æ­´è¡¨ç¤ºã‚¨ãƒªã‚¢ â–¼â–¼â–¼ -->
      <div id="qrHistoryArea" class="my-6">
        <h3 class="font-bold text-base mb-2">æœ€è¿‘ç”Ÿæˆã—ãŸQRã‚³ãƒ¼ãƒ‰</h3>
        <ul id="qrHistoryList" class="space-y-2 text-xs"></ul>
      </div>

      <!-- ã‚¹ãƒãƒ³ã‚µãƒ¼ãƒªãƒ³ã‚¯ãƒ©ãƒ™ãƒ«ï¼ˆåºƒå‘Šç›´å‰ï¼‰ -->
      <div class="text-xs text-gray-500 mb-1" aria-label="ã‚¹ãƒãƒ³ã‚µãƒ¼ãƒªãƒ³ã‚¯">ã‚¹ãƒãƒ³ã‚µãƒ¼ãƒªãƒ³ã‚¯</div>
      <!-- ã“ã“ã«åºƒå‘Šã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹: AdSenseï¼‰ã‚’æŒ¿å…¥ -->

      <!-- ãƒ„ãƒ¼ãƒ«ä¸‹éƒ¨ï¼šAmazonãƒ»æ¥½å¤©ãƒãƒŠãƒ¼ â†’ ãƒã‚¤ãƒ†ã‚£ãƒ–/ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆå‹•çš„è¡¨ç¤ºã«ç½®æ› -->
      <div id="smart-ads" class="flex justify-center my-8"></div>
      <script>
        document.addEventListener('DOMContentLoaded', function() {
          if (window.renderSmartAds) window.renderSmartAds('smart-ads');
        });
      </script>

      <!-- ãƒ•ãƒƒã‚¿ãƒ¼ç›´å‰ï¼šã‚¢ãƒ‰ã‚»ãƒ³ã‚¹ï¼ˆã‚¤ãƒ³ãƒ•ã‚£ãƒ¼ãƒ‰/ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ï¼‰ -->
      <div class="max-w-2xl mx-auto my-8">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-xxxxxxxxxxxxxxxx"
             data-ad-slot="0987654321"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>

      <!-- ç‹¬è‡ªæ€§èª¬æ˜ãƒ»å…è²¬äº‹é …ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <section class="mt-12 mb-8 text-sm text-gray-700 bg-white rounded-lg p-4 border border-gray-200" aria-label="ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦">
        <h2 class="font-bold text-base mb-2">negi-lab.comã®ç‹¬è‡ªæ€§ãƒ»é‹å–¶æ–¹é‡ãƒ»å…è²¬äº‹é …</h2>
        <ul class="list-disc ml-5 mb-2">
          <li>æœ¬ãƒ„ãƒ¼ãƒ«ã¯negi-lab.comãŒç‹¬è‡ªé–‹ç™ºãƒ»é‹å–¶ã—ã¦ã„ã¾ã™ã€‚</li>
          <li>åºƒå‘Šãƒ»ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆã‚’å«ã¿ã¾ã™ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’æœ€å„ªå…ˆã—ã¦ã„ã¾ã™ã€‚</li>
          <li>æ­£ç¢ºæ€§ãƒ»å®‰å…¨æ€§ã«ã¯ä¸‡å…¨ã‚’æœŸã—ã¦ã„ã¾ã™ãŒã€åˆ©ç”¨ã¯è‡ªå·±è²¬ä»»ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚</li>
        </ul>
        <p class="text-xs text-gray-500">&copy; 2025 negi-lab.com</p>
      </section>
    </div>
  </main>

  <footer class="bg-gray-800 text-gray-300 py-8 text-center text-sm">
    <nav class="mb-2">
      <a href="/privacy-policy.html" class="underline hover:text-accent mx-2">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
      <a href="/terms.html" class="underline hover:text-accent mx-2">åˆ©ç”¨è¦ç´„</a>
      <a href="/about.html" class="underline hover:text-accent mx-2">é‹å–¶è€…æƒ…å ±</a>
      <a href="mailto:negilab.com@gmail.com" class="underline hover:text-accent mx-2">ãŠå•ã„åˆã‚ã›</a>
      <a href="/sitemap.xml" class="underline hover:text-accent mx-2">ã‚µã‚¤ãƒˆãƒãƒƒãƒ—</a>
    </nav>
    <div>&copy; 2025 negi-lab.com</div>
  </footer>
  <!-- Guide Modal Popup -->
  <div id="guide-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 hidden" role="dialog" aria-modal="true" aria-labelledby="guide-modal-title">
    <div class="bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 my-8 max-h-screen flex flex-col">
      <div class="flex justify-between items-center p-6 border-b border-gray-200">
        <h2 class="text-xl font-bold text-gray-800">QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ« å®Œå…¨ã‚¬ã‚¤ãƒ‰</h2>
        <button id="guide-close" class="text-gray-400 hover:text-gray-600 text-2xl font-bold" aria-label="é–‰ã˜ã‚‹">&times;</button>
      </div>
      <div id="guide-modal-content" class="flex-1 overflow-y-auto p-6"></div>
    </div>
  </div>
  <script type="module" src="../index.js" defer></script>
  <script defer>
// CookieåŒæ„åˆ¤å®šï¼ˆconsent-bannerã®åŒæ„ãƒœã‚¿ãƒ³åˆ©ç”¨æƒ³å®šï¼‰
function isCookieConsentAccepted() {
  return localStorage.getItem('cookieConsent') === 'accepted';
}

// ã‚¿ãƒ–æ©Ÿèƒ½ã®å®Ÿè£…
function setupTabs() {
  const tabButtons = document.querySelectorAll('.tab-button');
  const tabContents = document.querySelectorAll('.tab-content');
  
  tabButtons.forEach(button => {
    button.addEventListener('click', () => {
      const targetId = button.id.replace('tab-', 'content-');
      
      // å…¨ã¦ã®ã‚¿ãƒ–ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
      tabButtons.forEach(btn => btn.classList.remove('active'));
      tabContents.forEach(content => content.classList.add('hidden'));
      
      // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
      button.classList.add('active');
      document.getElementById(targetId).classList.remove('hidden');
      
      // åŸºæœ¬è¨­å®šã‚¿ãƒ–ã®å ´åˆã¯è¿½åŠ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚‚è¡¨ç¤º
      if (targetId === 'content-basic') {
        const basicControls = document.getElementById('content-basic-controls');
        if (basicControls) basicControls.classList.remove('hidden');
      }
    });
  });
}

// é«˜åº¦ãªã‚«ãƒ©ãƒ¼è¨­å®š
function setupColorControls() {
  const colorPresets = document.querySelectorAll('.color-preset');
  const fgColorInput = document.getElementById('qrFgColor');
  const bgColorInput = document.getElementById('qrBgColor');
  const fgColorText = document.getElementById('qrFgColorText');
  const bgColorText = document.getElementById('qrBgColorText');
  
  // ãƒ—ãƒªã‚»ãƒƒãƒˆã‚«ãƒ©ãƒ¼
  colorPresets.forEach(preset => {
    preset.addEventListener('click', () => {
      const color = preset.dataset.color;
      const isForeground = preset.closest('.grid').children[0].contains(preset);
      
      if (isForeground) {
        fgColorInput.value = color;
        fgColorText.value = color;
      } else {
        bgColorInput.value = color;
        bgColorText.value = color;
      }
      
      updatePreview();
    });
  });
  
  // ã‚«ãƒ©ãƒ¼å…¥åŠ›åŒæœŸ
  if (fgColorInput && fgColorText) {
    fgColorInput.addEventListener('input', () => {
      fgColorText.value = fgColorInput.value;
      updatePreview();
    });
    fgColorText.addEventListener('input', () => {
      if (/^#[0-9A-F]{6}$/i.test(fgColorText.value)) {
        fgColorInput.value = fgColorText.value;
        updatePreview();
      }
    });
  }
  
  if (bgColorInput && bgColorText) {
    bgColorInput.addEventListener('input', () => {
      bgColorText.value = bgColorInput.value;
      updatePreview();
    });
    bgColorText.addEventListener('input', () => {
      if (/^#[0-9A-F]{6}$/i.test(bgColorText.value)) {
        bgColorInput.value = bgColorText.value;
        updatePreview();
      }
    });
  }
}

// ã‚µã‚¤ã‚ºã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼åŒæœŸ
function setupSizeControls() {
  const sizeSlider = document.getElementById('qrSizeSlider');
  const sizeInput = document.getElementById('qrSize');
  const logoSizeSlider = document.getElementById('logoSize');
  const logoSizeValue = document.getElementById('logoSizeValue');
  
  if (sizeSlider && sizeInput) {
    sizeSlider.addEventListener('input', () => {
      sizeInput.value = sizeSlider.value;
      updatePreview();
    });
    sizeInput.addEventListener('input', () => {
      sizeSlider.value = sizeInput.value;
      updatePreview();
    });
  }
  
  if (logoSizeSlider && logoSizeValue) {
    logoSizeSlider.addEventListener('input', () => {
      logoSizeValue.textContent = logoSizeSlider.value + '%';
      updatePreview();
    });
  }
}

// ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
function setupGradientControls() {
  const enableGradient = document.getElementById('enableGradient');
  const gradientControls = document.getElementById('gradientControls');
  
  if (enableGradient && gradientControls) {
    enableGradient.addEventListener('change', () => {
      if (enableGradient.checked) {
        gradientControls.classList.remove('hidden');
      } else {
        gradientControls.classList.add('hidden');
      }
      updatePreview();
    });
  }
}

// ä¸€æ‹¬ç”Ÿæˆæ©Ÿèƒ½
function setupBatchGeneration() {
  const batchGenerate = document.getElementById('batchGenerate');
  const batchDownload = document.getElementById('batchDownload');
  const batchInput = document.getElementById('batchInput');
  const batchProgress = document.getElementById('batchProgress');
  const batchProgressBar = document.getElementById('batchProgressBar');
  const batchProgressText = document.getElementById('batchProgressText');
  
  let batchResults = [];
  
  if (batchGenerate) {
    batchGenerate.addEventListener('click', async () => {
      const inputText = batchInput.value.trim();
      if (!inputText) {
        alert('ä¸€æ‹¬ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      const lines = inputText.split('\n').filter(line => line.trim()).slice(0, 100);
      const prefix = document.getElementById('batchPrefix').value || 'qrcode';
      const format = document.getElementById('batchFormat').value;
      
      batchResults = [];
      batchProgress.classList.remove('hidden');
      batchGenerate.disabled = true;
      
      for (let i = 0; i < lines.length; i++) {
        const data = lines[i].trim();
        const progress = ((i + 1) / lines.length) * 100;
        
        batchProgressBar.style.width = progress + '%';
        batchProgressText.textContent = `${i + 1} / ${lines.length}`;
        
        try {
          const canvas = await generateQrCanvas(data);
          if (canvas) {
            batchResults.push({
              filename: `${prefix}_${String(i + 1).padStart(3, '0')}.${format}`,
              canvas: canvas,
              data: data
            });
          }
        } catch (error) {
          console.error(`ãƒãƒƒãƒç”Ÿæˆã‚¨ãƒ©ãƒ¼ (${i + 1}):`, error);
        }
        
        // å°‘ã—å¾…æ©Ÿã—ã¦UIã®æ›´æ–°ã‚’ç¢ºå®Ÿã«ã™ã‚‹
        await new Promise(resolve => setTimeout(resolve, 50));
      }
      
      batchGenerate.disabled = false;
      batchDownload.disabled = batchResults.length === 0;
      
      if (batchResults.length > 0) {
        alert(`${batchResults.length}å€‹ã®QRã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸ`);
      }
    });
  }
    if (batchDownload) {
    batchDownload.addEventListener('click', async () => {
      if (batchResults.length === 0) return;
      
      const zip = new SimpleZip();
      const format = document.getElementById('batchFormat').value;
      
      batchResults.forEach(result => {
        const dataUrl = result.canvas.toDataURL(`image/${format === 'jpg' ? 'jpeg' : format}`, 0.9);
        const base64Data = dataUrl.split(',')[1];
        zip.file(result.filename, base64Data);
      });
      
      // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ 
      const metadata = {
        generated: new Date().toISOString(),
        count: batchResults.length,
        format: format,
        data: batchResults.map(r => ({filename: r.filename, data: r.data}))
      };
      zip.file('metadata.json', JSON.stringify(metadata, null, 2));
      
      const blob = await zip.generateAsync();
      saveAs(blob, `qrcodes_batch_${new Date().toISOString().slice(0, 10)}.json`);
      
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«èª¬æ˜
      alert('ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’JSONãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸã€‚GitHub Actionsã§å‡¦ç†ã§ãã¾ã™ã€‚');
    });
  }
}

// QRã‚³ãƒ¼ãƒ‰è§£ææ©Ÿèƒ½
function setupQrAnalysis() {
  const qrAnalyze = document.getElementById('qrAnalyze');
  const analyzeResult = document.getElementById('analyzeResult');
  
  if (qrAnalyze && analyzeResult) {
    qrAnalyze.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = (event) => {
        const img = new Image();
        img.onload = () => {
          try {
            // QRã‚³ãƒ¼ãƒ‰è§£æã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿéš›ã«ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ï¼‰
            analyzeResult.classList.remove('hidden');
            analyzeResult.innerHTML = `
              <strong>è§£æçµæœ:</strong><br>
              ãƒ•ã‚¡ã‚¤ãƒ«: ${file.name}<br>
              ã‚µã‚¤ã‚º: ${img.width} x ${img.height}<br>
              ãƒ‡ãƒ¼ã‚¿: [è§£æã«ã¯å°‚ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™]
            `;
          } catch (error) {
            analyzeResult.innerHTML = '<span class="text-red-500">è§£æã«å¤±æ•—ã—ã¾ã—ãŸ</span>';
          }
        };
        img.src = event.target.result;
      };
      reader.readAsDataURL(file);
    });
  }
}

// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ©Ÿèƒ½
function setupTemplates() {
  const saveTemplate = document.getElementById('saveTemplate');
  const templateSelect = document.getElementById('templateSelect');
  
  if (saveTemplate) {
    saveTemplate.addEventListener('click', () => {
      const name = prompt('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
      if (!name) return;
      
      const template = {
        name: name,
        settings: getCurrentSettings(),
        created: new Date().toISOString()
      };
      
      const templates = JSON.parse(localStorage.getItem('qrTemplates') || '[]');
      templates.push(template);
      localStorage.setItem('qrTemplates', JSON.stringify(templates));
      
      updateTemplateSelect();
      alert('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸ');
    });
  }
  
  if (templateSelect) {
    templateSelect.addEventListener('change', () => {
      const selectedId = templateSelect.value;
      if (!selectedId) return;
      
      const templates = JSON.parse(localStorage.getItem('qrTemplates') || '[]');
      const template = templates.find(t => t.name === selectedId);
      
      if (template) {
        applySettings(template.settings);
        updatePreview();
      }
    });
  }
  
  updateTemplateSelect();
}

function updateTemplateSelect() {
  const templateSelect = document.getElementById('templateSelect');
  if (!templateSelect) return;
  
  const templates = JSON.parse(localStorage.getItem('qrTemplates') || '[]');
  templateSelect.innerHTML = '<option value="">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ</option>';
  
  templates.forEach(template => {
    const option = document.createElement('option');
    option.value = template.name;
    option.textContent = template.name;
    templateSelect.appendChild(option);
  });
}

function getCurrentSettings() {
  return {
    size: document.getElementById('qrSize').value,
    errorCorrection: document.getElementById('qrErrorCorrection').value,
    fgColor: document.getElementById('qrFgColor').value,
    bgColor: document.getElementById('qrBgColor').value,
    margin: document.getElementById('qrMargin')?.value,
    pattern: document.getElementById('qrPattern')?.value,
    frame: document.getElementById('qrFrame')?.value
  };
}

function applySettings(settings) {
  Object.keys(settings).forEach(key => {
    const element = document.getElementById('qr' + key.charAt(0).toUpperCase() + key.slice(1));
    if (element) {
      element.value = settings[key];
    }
  });
}

// GitHub Actions YAMLç”Ÿæˆ
function setupGitHubIntegration() {
  const generateAction = document.getElementById('copyGithubAction');
  const actionTextarea = document.getElementById('githubAction');
    if (actionTextarea) {
    const yamlContent = `name: Generate QR Codes (Pure Static)
on:
  push:
    paths:
      - 'data/qr-data.txt'
      - 'data/qr-batch.json'
  workflow_dispatch:

jobs:
  generate-qr:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          
      - name: Generate QR Codes (No External Dependencies)
        run: |
          mkdir -p output
          
          # ãƒãƒƒãƒJSONãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®å‡¦ç†
          if [ -f "data/qr-batch.json" ]; then
            node -e "
            const fs = require('fs');
            const https = require('https');
            
            // Google Charts APIã‚’ä½¿ç”¨ï¼ˆCDNä¸è¦ï¼‰
            function generateQR(text, filename) {
              const size = 256;
              const url = \`https://chart.googleapis.com/chart?chs=\${size}x\${size}&cht=qr&chl=\${encodeURIComponent(text)}&choe=UTF-8\`;
              
              return new Promise((resolve, reject) => {
                const file = fs.createWriteStream(\`output/\${filename}\`);
                https.get(url, (response) => {
                  response.pipe(file);
                  file.on('finish', () => {
                    file.close();
                    resolve();
                  });
                }).on('error', reject);
              });
            }
            
            // ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†
            const batchData = JSON.parse(fs.readFileSync('data/qr-batch.json', 'utf8'));
            
            Promise.all(
              batchData.files.map(async (item, i) => {
                const text = item.data || item.name;
                const filename = \`qr-\${String(i+1).padStart(3, '0')}.png\`;
                await generateQR(text, filename);
                console.log(\`Generated: \${filename}\`);
              })
            ).then(() => {
              console.log('All QR codes generated successfully');
            }).catch(console.error);
            "
          fi
          
          # é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆã®å‡¦ç†
          if [ -f "data/qr-data.txt" ]; then
            node -e "
            const fs = require('fs');
            const https = require('https');
            
            const lines = fs.readFileSync('data/qr-data.txt', 'utf8').split('\\n').filter(line => line.trim());
            
            lines.forEach(async (line, i) => {
              if (line.trim()) {
                const size = 256;
                const url = \`https://chart.googleapis.com/chart?chs=\${size}x\${size}&cht=qr&chl=\${encodeURIComponent(line.trim())}&choe=UTF-8\`;
                const file = fs.createWriteStream(\`output/qr-\${i+1}.png\`);
                
                https.get(url, (response) => {
                  response.pipe(file);
                  file.on('finish', () => {
                    file.close();
                    console.log(\`Generated: qr-\${i+1}.png\`);
                  });
                });
              }
            });
            "
          fi
          
      - name: Commit generated files
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add output/
          git commit -m "Auto-generated QR codes [skip ci]" || exit 0
          git push
          
      - name: Upload artifacts
        uses: actions/upload-artifact@v4
        with:
          name: qr-codes
          path: output/`;
    
    actionTextarea.value = yamlContent;
  }
  
  if (generateAction) {
    generateAction.addEventListener('click', () => {
      navigator.clipboard.writeText(actionTextarea.value).then(() => {
        alert('GitHub Actions YAMLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
      });
    });
  }
}

// API ã‚­ãƒ¼ç”Ÿæˆ
function setupApiIntegration() {
  const generateApiKey = document.getElementById('generateApiKey');
  const apiKeyInput = document.getElementById('apiKey');
  const copyApiKey = document.getElementById('copyApiKey');
  
  if (generateApiKey && apiKeyInput) {
    generateApiKey.addEventListener('click', () => {
      const key = 'qr_' + Math.random().toString(36).substr(2, 16) + Date.now().toString(36);
      apiKeyInput.value = key;
      localStorage.setItem('qrApiKey', key);
    });
  }
  
  if (copyApiKey && apiKeyInput) {
    copyApiKey.addEventListener('click', () => {
      navigator.clipboard.writeText(apiKeyInput.value).then(() => {
        alert('APIã‚­ãƒ¼ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
      });
    });
  }
  
  // ä¿å­˜æ¸ˆã¿ã‚­ãƒ¼ã‚’èª­ã¿è¾¼ã¿
  const savedKey = localStorage.getItem('qrApiKey');
  if (savedKey && apiKeyInput) {
    apiKeyInput.value = savedKey;
  }
}

// çµ±è¨ˆæƒ…å ±æ›´æ–°
function updateStats() {
  const stats = JSON.parse(localStorage.getItem('qrStats') || '{"total": 0, "today": 0, "week": 0, "lastDate": ""}');
  const today = new Date().toDateString();
  const weekStart = new Date();
  weekStart.setDate(weekStart.getDate() - weekStart.getDay());
  
  if (stats.lastDate !== today) {
    stats.today = 0;
    stats.lastDate = today;
  }
  
  document.getElementById('statsTotal').textContent = stats.total || 0;
  document.getElementById('statsToday').textContent = stats.today || 0;
  document.getElementById('statsWeek').textContent = stats.week || 0;
}

function incrementStats() {
  const stats = JSON.parse(localStorage.getItem('qrStats') || '{"total": 0, "today": 0, "week": 0, "lastDate": ""}');
  const today = new Date().toDateString();
  
  stats.total = (stats.total || 0) + 1;
  stats.today = (stats.today || 0) + 1;
  stats.week = (stats.week || 0) + 1;
  stats.lastDate = today;
  
  localStorage.setItem('qrStats', JSON.stringify(stats));
  updateStats();
}

// CSV/Excel ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
function setupDataImport() {
  const csvImport = document.getElementById('csvImport');
  const batchInput = document.getElementById('batchInput');
  
  if (csvImport && batchInput) {
    csvImport.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = (event) => {
        try {
          const text = event.target.result;
          let data = [];
          
          if (file.name.endsWith('.csv')) {
            // ç°¡å˜ãªCSVè§£æ
            data = text.split('\n').map(line => line.split(',')[0]).filter(item => item.trim());
          } else if (file.name.endsWith('.json')) {
            const jsonData = JSON.parse(text);
            data = Array.isArray(jsonData) ? jsonData : [jsonData];
          }
          
          batchInput.value = data.join('\n');
          alert(`${data.length}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ`);
          
          // ä¸€æ‹¬ç”Ÿæˆã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ
          document.getElementById('tab-batch').click();
          
        } catch (error) {
          alert('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
        }
      };
      reader.readAsText(file);
    });
  }
}

// ã‚¬ã‚¤ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«è¨­å®š
function setupGuideModal() {
  const guideBtn = document.getElementById('guide-btn');
  const guideModal = document.getElementById('guide-modal');
  const guideClose = document.getElementById('guide-close');
  const guideContent = document.getElementById('guide-modal-content');
    if (guideBtn && guideModal && guideClose && guideContent) {    guideBtn.addEventListener('click', function() {
      guideContent.innerHTML = `
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <!-- å·¦ã‚«ãƒ©ãƒ  -->
          <div class="space-y-8">
            <!-- åŸºæœ¬çš„ãªä½¿ã„æ–¹ -->
            <section>
              <h3 class="font-semibold text-xl mb-4 text-gray-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd"></path>
                </svg>
                åŸºæœ¬çš„ãªä½¿ã„æ–¹
              </h3>
              <ol class="list-decimal ml-6 space-y-2 text-gray-700 text-sm">
                <li><strong>ãƒ‡ãƒ¼ã‚¿å½¢å¼</strong>ã‚’é¸æŠï¼ˆãƒ†ã‚­ã‚¹ãƒˆã€URLã€ãƒ¡ãƒ¼ãƒ«ã€Wi-Fiãªã©14ç¨®é¡å¯¾å¿œï¼‰</li>
                <li>å¿…è¦ãª<strong>æƒ…å ±ã‚’å…¥åŠ›</strong>ï¼ˆè‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ©Ÿèƒ½ä»˜ãï¼‰</li>
                <li>ã‚µã‚¤ã‚ºï¼ˆ128-1024pxï¼‰ã‚„è‰²ã‚’<strong>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</strong>ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</li>
                <li><strong>ã€ŒQRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã€</strong>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>PNG/JPG/SVGå½¢å¼ã§<strong>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</strong></li>
              </ol>
            </section>

            <!-- å…¨æ©Ÿèƒ½ã‚¿ãƒ–èª¬æ˜ -->
            <section>
              <h3 class="font-semibold text-xl mb-4 text-gray-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 11-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15.586 13H14a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                </svg>
                5ã¤ã®ã‚¿ãƒ–æ©Ÿèƒ½
              </h3>
              <div class="space-y-3">
                <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-400">
                  <strong class="text-green-700">1. åŸºæœ¬è¨­å®š:</strong> 
                  <p class="text-sm text-gray-600 mt-1">ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã€ã‚µã‚¤ã‚ºãƒ»è‰²ã®åŸºæœ¬è¨­å®šã€14ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼å¯¾å¿œ</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-400">
                  <strong class="text-blue-700">2. ãƒ‡ã‚¶ã‚¤ãƒ³:</strong>
                  <p class="text-sm text-gray-600 mt-1">é«˜åº¦ãªã‚«ãƒ©ãƒ¼è¨­å®šã€ã‚«ãƒ©ãƒ¼ãƒ—ãƒªã‚»ãƒƒãƒˆã€ãƒ­ã‚´ç”»åƒåˆæˆã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg border-l-4 border-purple-400">
                  <strong class="text-purple-700">3. ä¸€æ‹¬ç”Ÿæˆ:</strong>
                  <p class="text-sm text-gray-600 mt-1">CSV/JSONå…¥åŠ›ã€è¤‡æ•°QRã‚³ãƒ¼ãƒ‰ä¸€æ‹¬ç”Ÿæˆã€ãƒãƒƒãƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</p>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg border-l-4 border-orange-400">
                  <strong class="text-orange-700">4. é«˜åº¦ãªè¨­å®š:</strong>
                  <p class="text-sm text-gray-600 mt-1">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ã€QRè§£æã€å±¥æ­´ç®¡ç†ã€ä½¿ç”¨çµ±è¨ˆ</p>
                </div>
                <div class="bg-red-50 p-4 rounded-lg border-l-4 border-red-400">
                  <strong class="text-red-700">5. API/è‡ªå‹•åŒ–:</strong>
                  <p class="text-sm text-gray-600 mt-1">å®Œå…¨ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œã€ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆï¼ˆã‚µãƒ¼ãƒãƒ¼ä¸è¦ï¼‰</p>
                </div>
              </div>
            </section>

            <!-- å¯¾å¿œãƒ‡ãƒ¼ã‚¿å½¢å¼ -->
            <section>
              <h3 class="font-semibold text-xl mb-4 text-gray-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                  <path fill-rule="evenodd" d="M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6.5a.5.5 0 01-.5.5.5.5 0 01-.5-.5V7a1 1 0 00-1-1H7a1 1 0 00-1 1v8a2 2 0 002 2h4.5a.5.5 0 01.5.5.5.5 0 01-.5.5H8a3 3 0 01-3-3V5z" clip-rule="evenodd"></path>
                </svg>
                14ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼å¯¾å¿œ
              </h3>
              <div class="grid grid-cols-2 gap-2 text-sm">
                <div class="flex items-center"><span class="w-3 h-3 bg-green-400 rounded-full mr-2"></span>ãƒ†ã‚­ã‚¹ãƒˆãƒ»URL</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-blue-400 rounded-full mr-2"></span>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-purple-400 rounded-full mr-2"></span>é›»è©±ç•ªå·</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-yellow-400 rounded-full mr-2"></span>SMS</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-red-400 rounded-full mr-2"></span>é€£çµ¡å…ˆï¼ˆvCardï¼‰</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-indigo-400 rounded-full mr-2"></span>Wi-Fiæ¥ç¶šæƒ…å ±</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-pink-400 rounded-full mr-2"></span>ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-gray-400 rounded-full mr-2"></span>ä½ç½®æƒ…å ±ãƒ»åœ°å›³</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>LINEãƒ»SNS</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-orange-400 rounded-full mr-2"></span>æš—å·é€šè²¨ãƒ»æ±ºæ¸ˆ</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-teal-400 rounded-full mr-2"></span>MeCardï¼ˆååˆºï¼‰</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-cyan-400 rounded-full mr-2"></span>YouTubeãƒ»Spotify</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>Zoomä¼šè­°å®¤</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-green-600 rounded-full mr-2"></span>PayPalé€é‡‘</div>
              </div>
            </section>
          </div>

          <!-- å³ã‚«ãƒ©ãƒ  -->
          <div class="space-y-8">
            <!-- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ -->
            <section>
              <h3 class="font-semibold text-xl mb-4 text-gray-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼
              </h3>
              <div class="space-y-3 text-sm text-gray-700">
                <div class="bg-green-50 p-3 rounded border border-green-200">
                  <strong class="text-green-700">ğŸ”’ å®Œå…¨ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†:</strong> 
                  ãƒ‡ãƒ¼ã‚¿ã¯ã‚ãªãŸã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ã¿å‡¦ç†ã•ã‚Œã€å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“
                </div>
                <div class="bg-blue-50 p-3 rounded border border-blue-200">
                  <strong class="text-blue-700">ğŸš« å¤–éƒ¨ä¾å­˜ãªã—:</strong> 
                  CDNãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã›ãšã€å®Œå…¨ã«ç‹¬ç«‹ã—ãŸãƒ„ãƒ¼ãƒ«ã§ã™
                </div>
                <div class="bg-purple-50 p-3 rounded border border-purple-200">
                  <strong class="text-purple-700">ğŸ“± ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ:</strong> 
                  ä¸€åº¦èª­ã¿è¾¼ã‚ã°ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šãªã—ã§ã‚‚å‹•ä½œã—ã¾ã™
                </div>
                <div class="bg-orange-50 p-3 rounded border border-orange-200">
                  <strong class="text-orange-700">ğŸª Cookieè¨­å®š:</strong> 
                  çµ±è¨ˆæ©Ÿèƒ½ã‚„ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆæ©Ÿèƒ½ã¯æ˜ç¤ºçš„ãªåŒæ„ãŒå¿…è¦ã§ã™
                </div>
              </div>
            </section>

            <!-- é«˜åº¦ãªæ©Ÿèƒ½ -->
            <section>
              <h3 class="font-semibold text-xl mb-4 text-gray-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-indigo-500" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"></path>
                  <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"></path>
                </svg>
                é«˜åº¦ãªæ©Ÿèƒ½
              </h3>
              <ul class="space-y-3 text-sm text-gray-700">
                <li class="flex items-start">
                  <span class="w-2 h-2 bg-indigo-400 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                  <div>
                    <strong>ãƒ­ã‚´ç”»åƒåˆæˆ:</strong> PNG/JPGç”»åƒã‚’QRã‚³ãƒ¼ãƒ‰ä¸­å¤®ã«é…ç½®
                  </div>
                </li>
                <li class="flex items-start">
                  <span class="w-2 h-2 bg-green-400 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                  <div>
                    <strong>ã‚«ãƒ©ãƒ¼ãƒ—ãƒªã‚»ãƒƒãƒˆ:</strong> ãƒ“ã‚¸ãƒã‚¹ã€SNSã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãªã©ç”¨é€”åˆ¥é…è‰²
                  </div>
                </li>
                <li class="flex items-start">
                  <span class="w-2 h-2 bg-blue-400 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                  <div>
                    <strong>ä¸€æ‹¬ç”Ÿæˆ:</strong> CSV/JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å¤§é‡ã®QRã‚³ãƒ¼ãƒ‰ã‚’ä¸€åº¦ã«ç”Ÿæˆ
                  </div>
                </li>
                <li class="flex items-start">
                  <span class="w-2 h-2 bg-purple-400 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                  <div>
                    <strong>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ©Ÿèƒ½:</strong> è¨­å®šã®ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ã§ä½œæ¥­åŠ¹ç‡åŒ–
                  </div>
                </li>
                <li class="flex items-start">
                  <span class="w-2 h-2 bg-yellow-400 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                  <div>
                    <strong>QRè§£æ:</strong> æ—¢å­˜QRã‚³ãƒ¼ãƒ‰ã®å†…å®¹è§£æãƒ»ãƒ‡ã‚³ãƒ¼ãƒ‰æ©Ÿèƒ½
                  </div>
                </li>
                <li class="flex items-start">
                  <span class="w-2 h-2 bg-red-400 rounded-full mr-3 mt-2 flex-shrink-0"></span>
                  <div>
                    <strong>ä½¿ç”¨çµ±è¨ˆ:</strong> ç”Ÿæˆå±¥æ­´ãƒ»ä½¿ç”¨çŠ¶æ³ã®è¿½è·¡ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰
                  </div>
                </li>
              </ul>
            </section>

            <!-- ä½¿ç”¨ä¾‹ -->
            <section>
              <h3 class="font-semibold text-xl mb-4 text-gray-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                </svg>
                å®Ÿç”¨çš„ãªä½¿ç”¨ä¾‹
              </h3>
              <div class="space-y-3 text-sm">
                <div class="bg-gray-50 p-3 rounded border-l-4 border-green-400">
                  <strong class="text-green-700">ğŸ¢ ãƒ“ã‚¸ãƒã‚¹:</strong> ååˆºã€åº—èˆ—æƒ…å ±ã€Wi-Fiãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…±æœ‰
                </div>
                <div class="bg-gray-50 p-3 rounded border-l-4 border-blue-400">
                  <strong class="text-blue-700">ğŸ“± SNS:</strong> Instagramã€Xï¼ˆTwitterï¼‰ã€YouTubeã€TikTokãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
                </div>
                <div class="bg-gray-50 p-3 rounded border-l-4 border-purple-400">
                  <strong class="text-purple-700">ğŸ‰ ã‚¤ãƒ™ãƒ³ãƒˆ:</strong> å‚åŠ ç™»éŒ²ã€ä¼šå ´æ¡ˆå†…ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¿½åŠ 
                </div>
                <div class="bg-gray-50 p-3 rounded border-l-4 border-yellow-400">
                  <strong class="text-yellow-700">ğŸ’° æ±ºæ¸ˆ:</strong> PayPalé€é‡‘ã€æš—å·é€šè²¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã€é€é‡‘ä¾é ¼
                </div>
                <div class="bg-gray-50 p-3 rounded border-l-4 border-red-400">
                  <strong class="text-red-700">ğŸ”— å…±æœ‰:</strong> ãƒ•ã‚¡ã‚¤ãƒ«å…±æœ‰ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ã€ä½ç½®æƒ…å ±
                </div>
              </div>
            </section>

            <!-- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° -->
            <section>
              <h3 class="font-semibold text-xl mb-4 text-gray-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                </svg>
                ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
              </h3>
              <div class="space-y-3 text-sm">
                <div class="border border-red-200 bg-red-50 p-3 rounded">
                  <strong class="text-red-700">Q: QRã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œãªã„</strong>
                  <ul class="mt-2 ml-4 list-disc text-gray-600">
                    <li>ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãå…¥åŠ›ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª</li>
                    <li>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªï¼ˆGoogle Charts APIä½¿ç”¨ï¼‰</li>
                    <li>ãƒ–ãƒ©ã‚¦ã‚¶ã® JavaScript ãŒæœ‰åŠ¹ã‹ç¢ºèª</li>
                    <li>ãƒ‡ãƒ¼ã‚¿é‡ãŒå¤§ãã™ãã‚‹å ´åˆã¯çŸ­ç¸®ã—ã¦ã¿ã‚‹</li>
                  </ul>
                </div>
                <div class="border border-orange-200 bg-orange-50 p-3 rounded">
                  <strong class="text-orange-700">Q: ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ããªã„</strong>
                  <ul class="mt-2 ml-4 list-disc text-gray-600">
                    <li>ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ–ãƒ­ãƒƒã‚«ãƒ¼ã‚’ç„¡åŠ¹ã«ã™ã‚‹</li>
                    <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰è¨±å¯è¨­å®šã‚’ç¢ºèª</li>
                    <li>åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆChromeã€Firefoxã€Safariï¼‰ã§è©¦ã™</li>
                  </ul>
                </div>
                <div class="border border-blue-200 bg-blue-50 p-3 rounded">
                  <strong class="text-blue-700">Q: ãƒ­ã‚´ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„</strong>
                  <ul class="mt-2 ml-4 list-disc text-gray-600">
                    <li>PNG ã¾ãŸã¯ JPG å½¢å¼ã®ç”»åƒã‚’ä½¿ç”¨</li>
                    <li>ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ããªã„ã‹ç¢ºèªï¼ˆæ¨å¥¨: 1MBä»¥ä¸‹ï¼‰</li>
                    <li>æ­£æ–¹å½¢ã«è¿‘ã„ç”»åƒãŒæœ€é©</li>
                  </ul>
                </div>
              </div>
            </section>
          </div>
        </div>

        <!-- ä¸‹éƒ¨ã®è¿½åŠ æƒ…å ± -->
        <div class="mt-8 pt-6 border-t border-gray-200">
          <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg border border-green-200">
            <h4 class="font-semibold text-lg text-gray-800 mb-3 flex items-center">
              <svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
              </svg>
              ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700">
              <div>
                <p><strong>ğŸŒŸ ç‰¹å¾´:</strong> å®Œå…¨ç„¡æ–™ã€ç™»éŒ²ä¸è¦ã€å¤–éƒ¨ä¾å­˜ãªã—</p>
                <p><strong>ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:</strong> å®Œå…¨ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ã€ãƒ‡ãƒ¼ã‚¿é€ä¿¡ãªã—</p>
                <p><strong>âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹:</strong> é«˜é€Ÿç”Ÿæˆã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ</p>
              </div>
              <div>
                <p><strong>ğŸ¨ ãƒ‡ã‚¶ã‚¤ãƒ³:</strong> 14ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã€ãƒ­ã‚´åˆæˆå¯¾å¿œ</p>
                <p><strong>ğŸ“Š ç®¡ç†:</strong> å±¥æ­´ä¿å­˜ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ©Ÿèƒ½ã€çµ±è¨ˆè¡¨ç¤º</p>
                <p><strong>ğŸš€ æ‹¡å¼µæ€§:</strong> APIæ©Ÿèƒ½ã€ä¸€æ‹¬ç”Ÿæˆã€è‡ªå‹•åŒ–å¯¾å¿œ</p>
              </div>
            </div>
          </div>
        </div>
      `;
      guideModal.classList.remove('hidden');
    });

    guideClose.addEventListener('click', function() {
      guideModal.classList.add('hidden');
    });

    guideModal.addEventListener('click', function(e) {
      if (e.target === guideModal) {
        guideModal.classList.add('hidden');      }
    });
  }
}

// QRã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—åˆ‡ã‚Šæ›¿ãˆè¨­å®š
function setupQrTypeSwitcher() {
  const qrTypeSelect = document.getElementById('qrType');
  if (!qrTypeSelect) return;
  
  qrTypeSelect.addEventListener('change', function() {
    const selectedType = this.value;
    const allInputs = document.querySelectorAll('#qrInputFields > div');
    
    allInputs.forEach(div => {
      div.style.display = 'none';
    });
    
    const selectedInput = document.getElementById('qrInput-' + selectedType);
    if (selectedInput) {
      selectedInput.style.display = 'block';
    }
  });
  
  // åˆæœŸçŠ¶æ…‹è¨­å®š
  qrTypeSelect.dispatchEvent(new Event('change'));
}

// ã‚¿ã‚¤ãƒ—åˆ¥ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆæ‹¡å¼µç‰ˆï¼‰
function getQrDataByType() {
  const qrType = document.getElementById('qrType').value;
  
  switch(qrType) {
    case 'text':
      return document.getElementById('qrData').value || '';
    case 'email':
      const email = document.getElementById('qrEmail').value;
      const subject = document.getElementById('qrEmailSubject').value;
      const body = document.getElementById('qrEmailBody').value;
      let mailto = 'mailto:' + email;
      const params = [];
      if (subject) params.push('subject=' + encodeURIComponent(subject));
      if (body) params.push('body=' + encodeURIComponent(body));
      if (params.length > 0) mailto += '?' + params.join('&');
      return mailto;
    case 'tel':
      return 'tel:' + document.getElementById('qrTel').value;
    case 'sms':
      const smsNumber = document.getElementById('qrSmsNumber').value;
      const smsBody = document.getElementById('qrSmsBody').value;
      return 'sms:' + smsNumber + (smsBody ? '?body=' + encodeURIComponent(smsBody) : '');
    case 'vcard':
      const name = document.getElementById('qrVcardName').value;
      const tel = document.getElementById('qrVcardTel').value;
      const email2 = document.getElementById('qrVcardEmail').value;
      const org = document.getElementById('qrVcardOrg').value;
      return `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\nTEL:${tel}\nEMAIL:${email2}\nORG:${org}\nEND:VCARD`;
    case 'wifi':
      const ssid = document.getElementById('qrWifiSsid').value;
      const pass = document.getElementById('qrWifiPass').value;
      const type = document.getElementById('qrWifiType').value;
      return `WIFI:T:${type};S:${ssid};P:${pass};;`;
    case 'event':
      const title = document.getElementById('qrEventTitle').value;
      const start = document.getElementById('qrEventStart').value;
      const end = document.getElementById('qrEventEnd').value;
      const location = document.getElementById('qrEventLocation').value;
      const desc = document.getElementById('qrEventDesc').value;
      const startDate = start ? new Date(start).toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z' : '';
      const endDate = end ? new Date(end).toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z' : '';
      return `BEGIN:VEVENT\nSUMMARY:${title}\nDTSTART:${startDate}\nDTEND:${endDate}\nLOCATION:${location}\nDESCRIPTION:${desc}\nEND:VEVENT`;
    case 'geo':
      const lat = document.getElementById('qrGeoLat').value;
      const lng = document.getElementById('qrGeoLng').value;
      return `geo:${lat},${lng}`;
    case 'line':
      return document.getElementById('qrLineUrl').value || '';    case 'crypto':
      const addr = document.getElementById('qrCryptoAddr').value;
      const cryptoType = document.getElementById('qrCryptoType').value;
      const amount = document.getElementById('qrCryptoAmount').value;
      
      if (!addr) return '';
      
      switch(cryptoType) {
        case 'bitcoin':
          return amount ? `bitcoin:${addr}?amount=${amount}` : `bitcoin:${addr}`;
        case 'ethereum':
          return amount ? `ethereum:${addr}?value=${amount}` : `ethereum:${addr}`;
        case 'litecoin':
          return amount ? `litecoin:${addr}?amount=${amount}` : `litecoin:${addr}`;
        case 'dogecoin':
          return amount ? `dogecoin:${addr}?amount=${amount}` : `dogecoin:${addr}`;
        default:
          return addr;
      }
    case 'mecard':
      const mecardName = document.getElementById('qrMecardName').value;
      const mecardReading = document.getElementById('qrMecardReading').value;
      const mecardPhone = document.getElementById('qrMecardPhone').value;
      const mecardEmail = document.getElementById('qrMecardEmail').value;
      return `MECARD:N:${mecardName};SOUND:${mecardReading};TEL:${mecardPhone};EMAIL:${mecardEmail};;`;
    case 'bookmark':
      const bookmarkTitle = document.getElementById('qrBookmarkTitle').value;
      const bookmarkUrl = document.getElementById('qrBookmarkUrl').value;
      return `MEBKM:TITLE:${bookmarkTitle};URL:${bookmarkUrl};;`;
    case 'youtube':
      return document.getElementById('qrYoutubeUrl').value || '';
    case 'spotify':
      return document.getElementById('qrSpotifyUrl').value || '';
    case 'zoom':
      const zoomId = document.getElementById('qrZoomId').value;
      const zoomPass = document.getElementById('qrZoomPass').value;
      return `https://zoom.us/j/${zoomId.replace(/\D/g, '')}${zoomPass ? '?pwd=' + zoomPass : ''}`;
    case 'paypal':
      return document.getElementById('qrPaypalUrl').value || '';
    default:
      return '';
  }
}

// é«˜åº¦ãªQRã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆCanvasç”¨ï¼‰- è‡ªä½œå®Ÿè£…ç‰ˆ
async function generateQrCanvas(text, customOptions = {}) {
  try {
    const size = parseInt(document.getElementById('batchSize')?.value || document.getElementById('qrSize')?.value) || 256;
    const fg = document.getElementById('qrFgColor')?.value || '#000000';
    const bg = document.getElementById('qrBgColor')?.value || '#ffffff';
    
    const options = {
      size: size,
      foreground: fg,
      background: bg,
      ...customOptions
    };
    
    return await SimpleQR.generate(text, options);
  } catch (error) {
    console.error('QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
    throw error;
  }
}

// é«˜åº¦ãªã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°é©ç”¨
function applyAdvancedStyling(ctx, canvas, pattern, enableGradient) {
  if (enableGradient) {
    const gradientStart = document.getElementById('gradientStart')?.value || '#000000';
    const gradientEnd = document.getElementById('gradientEnd')?.value || '#666666';
    
    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
    gradient.addColorStop(0, gradientStart);
    gradient.addColorStop(1, gradientEnd);
    
    // ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    ctx.globalCompositeOperation = 'multiply';
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.globalCompositeOperation = 'source-over';
  }
  
  // ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã¯è¤‡é›‘ãªãŸã‚ã€åŸºæœ¬å®Ÿè£…ã®ã¿
  if (pattern === 'circle') {
    // å††å½¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿè£…ãŒè¤‡é›‘ãªãŸã‚çœç•¥ï¼‰
    console.log('Circle pattern applied');
  }
}

// URLçŸ­ç¸®æ©Ÿèƒ½
async function setupUrlShortener() {
  const shortenBtn = document.getElementById('shortenUrl');
  const urlShortenerSelect = document.getElementById('urlShortener');
  
  if (shortenBtn) {
    shortenBtn.addEventListener('click', async () => {
      const qrData = document.getElementById('qrData').value;
      if (!qrData || !qrData.startsWith('http')) {
        alert('æœ‰åŠ¹ãªURLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      try {
        const service = urlShortenerSelect.value;
        let shortUrl = '';
        
        if (service === 'tinyurl') {
          // TinyURL APIï¼ˆå…¬é–‹APIï¼‰
          const response = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(qrData)}`);
          shortUrl = await response.text();
        } else {
          // ã‚«ã‚¹ã‚¿ãƒ çŸ­ç¸®ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè£…ï¼‰
          shortUrl = `https://negi.ly/${Math.random().toString(36).substr(2, 8)}`;
        }
        
        if (shortUrl && shortUrl.startsWith('http')) {
          document.getElementById('qrData').value = shortUrl;
          updatePreview();
          alert('URLã‚’çŸ­ç¸®ã—ã¾ã—ãŸ: ' + shortUrl);
        } else {
          throw new Error('çŸ­ç¸®ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      } catch (error) {
        console.error('URLçŸ­ç¸®ã‚¨ãƒ©ãƒ¼:', error);
        alert('URLçŸ­ç¸®ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
      }
    });
  }
}

// YouTubeæƒ…å ±å–å¾—
function setupYouTubeExtractor() {
  const extractBtn = document.getElementById('extractYoutube');
  
  if (extractBtn) {
    extractBtn.addEventListener('click', () => {
      const url = document.getElementById('qrYoutubeUrl').value;
      if (!url) return;
      
      try {
        const videoId = extractYouTubeId(url);
        if (videoId) {
          // YouTube oEmbed APIï¼ˆCORSåˆ¶é™ã®ãŸã‚é™å®šçš„ï¼‰
          alert(`Video ID: ${videoId}\nçŸ­ç¸®URL: https://youtu.be/${videoId}`);
          document.getElementById('qrYoutubeUrl').value = `https://youtu.be/${videoId}`;
        } else {
          alert('æœ‰åŠ¹ãªYouTube URLã§ã¯ã‚ã‚Šã¾ã›ã‚“');
        }
      } catch (error) {
        alert('YouTube URLè§£æã‚¨ãƒ©ãƒ¼: ' + error.message);
      }
    });
  }
}

function extractYouTubeId(url) {
  const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&\?]*).*/;
  const match = url.match(regExp);
  return (match && match[7].length === 11) ? match[7] : null;
}

// Webhookæ©Ÿèƒ½
function setupWebhook() {
  const enableWebhook = document.getElementById('enableWebhook');
  
  if (enableWebhook) {
    enableWebhook.addEventListener('change', () => {
      const isEnabled = enableWebhook.checked;
      localStorage.setItem('webhookEnabled', isEnabled);
    });
    
    // è¨­å®šèª­ã¿è¾¼ã¿
    const savedSetting = localStorage.getItem('webhookEnabled');
    if (savedSetting === 'true') {
      enableWebhook.checked = true;
    }
  }
}

async function sendWebhook(data) {
  const webhookUrl = document.getElementById('webhookUrl')?.value;
  const isEnabled = document.getElementById('enableWebhook')?.checked;
  
  if (!isEnabled || !webhookUrl) return;
  
  try {
    await fetch(webhookUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        type: 'qr_generated',
        data: data,
        timestamp: new Date().toISOString(),
        source: 'negi-lab.com'
      })
    });
  } catch (error) {
    console.error('Webhooké€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
  }
}

// QRã‚³ãƒ¼ãƒ‰å±¥æ­´ä¿å­˜
function saveQrHistory(type, data, options) {
  if (!data) return;
  
  let history = JSON.parse(localStorage.getItem('qrHistory') || '[]');
  const newEntry = {
    id: Date.now(),
    type: type,
    data: data,
    options: options,
    timestamp: new Date().toISOString()
  };
  
  history.unshift(newEntry);
  history = history.slice(0, 10); // æœ€æ–°10ä»¶ã¾ã§ä¿æŒ
  
  localStorage.setItem('qrHistory', JSON.stringify(history));
}

// QRã‚³ãƒ¼ãƒ‰å±¥æ­´è¡¨ç¤º
function renderQrHistory() {
  const historyList = document.getElementById('qrHistoryList');
  if (!historyList) return;
  
  const history = JSON.parse(localStorage.getItem('qrHistory') || '[]');
  
  if (history.length === 0) {
    historyList.innerHTML = '<li class="text-gray-500">å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</li>';
    return;
  }
  
  historyList.innerHTML = history.map(entry => {
    const date = new Date(entry.timestamp).toLocaleString('ja-JP');
    const shortData = entry.data.length > 30 ? entry.data.substring(0, 30) + '...' : entry.data;
    return `
      <li class="flex justify-between items-center p-2 bg-gray-100 rounded">
        <div>
          <span class="font-medium">${entry.type}</span>: ${shortData}
          <div class="text-gray-500">${date}</div>
        </div>
        <button onclick="regenerateFromHistory(${entry.id})" class="text-accent hover:text-emerald-600">å†ç”Ÿæˆ</button>
      </li>
    `;
  }).join('');
}

// å±¥æ­´ã‹ã‚‰å†ç”Ÿæˆ
function regenerateFromHistory(id) {
  const history = JSON.parse(localStorage.getItem('qrHistory') || '[]');
  const entry = history.find(h => h.id === id);
  if (!entry) return;
  
  // ãƒ•ã‚©ãƒ¼ãƒ ã«å€¤ã‚’è¨­å®š
  document.getElementById('qrType').value = entry.type;
  document.getElementById('qrType').dispatchEvent(new Event('change'));
  
  // ã‚¿ã‚¤ãƒ—åˆ¥ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å€¤ã‚’è¨­å®š
  switch(entry.type) {
    case 'text':
      document.getElementById('qrData').value = entry.data;
      break;
    // ä»–ã®ã‚¿ã‚¤ãƒ—ã‚‚å¿…è¦ã«å¿œã˜ã¦å®Ÿè£…
  }
  
  if (entry.options) {
    if (entry.options.size) document.getElementById('qrSize').value = entry.options.size;
    if (entry.options.fg) document.getElementById('qrFgColor').value = entry.options.fg;
    if (entry.options.bg) document.getElementById('qrBgColor').value = entry.options.bg;
  }
  
  updatePreview();
}

// ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ï¼ˆå…¥åŠ›å€¤å¤‰æ›´æ™‚ã«å³æ™‚åæ˜ ï¼‰
function setupQrPreview() {
  const inputs = [
    'qrType','qrData','qrEmail','qrEmailSubject','qrEmailBody','qrTel','qrSmsNumber','qrSmsBody',
    'qrVcardName','qrVcardTel','qrVcardEmail','qrVcardOrg','qrWifiSsid','qrWifiPass','qrWifiType',
    'qrEventTitle','qrEventStart','qrEventEnd','qrEventLocation','qrEventDesc','qrGeoLat','qrGeoLng',
    'qrLineUrl','qrCryptoAddr','qrCryptoType','qrSize','qrFgColor','qrBgColor','qrLogo','qrErrorCorrection'
  ];
  
  inputs.forEach(id => {
    const el = document.getElementById(id);
    if (el) {
      el.addEventListener('input', debounce(updatePreview, 300));
      el.addEventListener('change', updatePreview);
    }
  });
  
  // åˆæœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
  setTimeout(updatePreview, 500);
}

// ãƒ‡ãƒã‚¦ãƒ³ã‚¹é–¢æ•°ï¼ˆå…¥åŠ›ä¸­ã®éåº¦ãªå‡¦ç†ã‚’é˜²ãï¼‰
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

function updatePreview() {
  const qrData = getQrDataByType();
  const qrcodeOutput = document.getElementById('qrcodeOutput');
  
  console.log('updatePreview called with data:', qrData);
  
  if (!qrData || qrData.trim() === '') {
    qrcodeOutput.innerHTML = '<span class="text-gray-500">ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹ã¨ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</span>';
    document.getElementById('qrResultContainer').classList.add('hidden');
    return;
  }
  
  const size = parseInt(document.getElementById('qrSize').value) || 256;
  const fg = document.getElementById('qrFgColor').value;
  const bg = document.getElementById('qrBgColor').value;
  const logoInput = document.getElementById('qrLogo');
  const enableAffiliates = shouldShowAdBanner();
  const logoFile = logoInput && logoInput.files && logoInput.files[0] ? logoInput.files[0] : null;
  
  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
  qrcodeOutput.innerHTML = '<div class="flex items-center justify-center h-32"><span class="text-gray-500">ç”Ÿæˆä¸­...</span></div>';
  
  // å°‘ã—é…å»¶ã‚’å…¥ã‚Œã¦ãƒ–ãƒ©ã‚¦ã‚¶ã®æç”»ã‚’å¾…ã¤
  setTimeout(() => {
    generateQrCode(qrData, size, fg, bg, logoFile, enableAffiliates);
  }, 100);
}

// åºƒå‘Šåˆæˆå¯å¦åˆ¤å®šï¼ˆCookieåŸ‹ã‚è¾¼ã¿ç”¨ï¼‰
function shouldShowAdBanner() {
  if (isCookieConsentAccepted()) return true;
  const cb = document.getElementById('qrAdBannerToggle');
  return cb && cb.checked;
}

// ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆCookieåŸ‹ã‚è¾¼ã¿å‡¦ç†
function embedAffiliateCookies() {
  if (!shouldShowAdBanner()) return;
  
  try {
    // Amazon ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆ Cookie
    const amazonImg = document.createElement('img');
    amazonImg.src = 'https://www.amazon.co.jp/assoc-redirect?tag=negilab01-22';
    amazonImg.width = 1;
    amazonImg.height = 1;
    amazonImg.style.display = 'none';
    amazonImg.style.position = 'absolute';
    amazonImg.style.left = '-9999px';
    amazonImg.referrerPolicy = 'no-referrer';
    document.body.appendChild(amazonImg);
    
    // æ¥½å¤©ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆ Cookie
    const rakutenImg = document.createElement('img');
    rakutenImg.src = 'https://ad.rakuten.co.jp/s/?id=4910d747.d15dc188.4910d748.d56fc6c6';
    rakutenImg.width = 1;
    rakutenImg.height = 1;
    rakutenImg.style.display = 'none';
    rakutenImg.style.position = 'absolute';
    rakutenImg.style.left = '-9999px';
    rakutenImg.referrerPolicy = 'no-referrer';
    document.body.appendChild(rakutenImg);
    
    console.log('ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆCookieåŸ‹ã‚è¾¼ã¿å®Œäº†');
  } catch (error) {
    console.error('CookieåŸ‹ã‚è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
  }
}

// åºƒå‘Šåˆæˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®è¡¨ç¤ºåˆ¶å¾¡
function setupAdBannerToggleDisplay() {
  const adBox = document.getElementById('qrAdBannerToggleBox');
  const adPreview = document.getElementById('adBannerPreview');
  const adToggle = document.getElementById('qrAdBannerToggle');
  
  if (!adBox) return;
  
  if (isCookieConsentAccepted()) {
    adBox.style.display = 'none';
    if (adPreview) adPreview.style.display = 'none';
    if (adToggle) adToggle.checked = true;
    // CookieåŒæ„æ¸ˆã¿ã®å ´åˆã€è‡ªå‹•çš„ã«ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–
    embedAffiliateCookies();
  } else {
    adBox.style.display = '';
    
    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–
    if (adToggle && adPreview) {
      adToggle.addEventListener('change', function() {
        if (this.checked) {
          adPreview.classList.remove('hidden');
          // ãƒã‚§ãƒƒã‚¯æ™‚ã«CookieåŸ‹ã‚è¾¼ã¿å®Ÿè¡Œ
          embedAffiliateCookies();
        } else {
          adPreview.classList.add('hidden');
        }
        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚‚æ›´æ–°
        updatePreview();
      });
    }
  }
}

// QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆè‡ªä½œå®Ÿè£…ç‰ˆï¼‰
async function generateQrCode(text, size, fgColor, bgColor, logoFile, enableAffiliates) {
  if (!text) {
    console.log('ãƒ†ã‚­ã‚¹ãƒˆãŒç©ºã§ã™');
    showError('ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }
  
  console.log('QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆé–‹å§‹:', text);
  
  // ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆæ©Ÿèƒ½ãŒæœ‰åŠ¹ãªå ´åˆã¯CookieåŸ‹ã‚è¾¼ã¿
  if (enableAffiliates) {
    embedAffiliateCookies();
  }
  
  try {
    const qrcodeOutput = document.getElementById('qrcodeOutput');
    const resultContainer = document.getElementById('qrResultContainer');
    
    if (!qrcodeOutput) {
      throw new Error('QRã‚³ãƒ¼ãƒ‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    }
    
    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
    qrcodeOutput.innerHTML = '<div class="flex items-center justify-center h-32"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"></div><span class="ml-2 text-gray-500">ç”Ÿæˆä¸­...</span></div>';
    
    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®ç”»åƒç”Ÿæˆï¼ˆCORSå•é¡Œå›é¿ï¼‰
    const previewImg = await SimpleQR.generate(text, {
      size: size,
      foreground: fgColor || '#000000',
      background: bgColor || '#ffffff',
      errorCorrection: document.getElementById('qrErrorCorrection')?.value || 'M'
    });
    
    if (!previewImg) {
      throw new Error('QRã‚³ãƒ¼ãƒ‰ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
    
    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
    qrcodeOutput.innerHTML = '';
    qrcodeOutput.appendChild(previewImg);
    
    console.log('QRã‚³ãƒ¼ãƒ‰ç”ŸæˆæˆåŠŸ');
    
    // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨ã®Canvasç”Ÿæˆã¯åˆ¥é€”å®Ÿè¡Œ
    window.currentQRData = {
      text: text,
      size: size,
      fgColor: fgColor,
      bgColor: bgColor,
      logoFile: logoFile,
      errorCorrection: document.getElementById('qrErrorCorrection')?.value || 'M'
    };
    
    if (resultContainer) {
      resultContainer.classList.remove('hidden');
    }
    
    showSuccess('QRã‚³ãƒ¼ãƒ‰ã‚’æ­£å¸¸ã«ç”Ÿæˆã—ã¾ã—ãŸï¼');
    
  } catch (error) {
    console.error('QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
    
    // ã‚¨ãƒ©ãƒ¼ç”»é¢ã®è¡¨ç¤º
    const qrcodeOutput = document.getElementById('qrcodeOutput');
    if (qrcodeOutput) {
      qrcodeOutput.innerHTML = `
        <div class="flex flex-col items-center justify-center h-32 bg-red-50 border border-red-200 rounded">
          <svg class="w-8 h-8 text-red-500 mb-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
          </svg>
          <span class="text-red-600 text-sm">ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ</span>
        </div>
      `;
    }
    
    showError('QRã‚³ãƒ¼ãƒ‰ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ã‚„ã‚µã‚¤ã‚ºã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
  }
}

// ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–¢æ•°
async function downloadQRCode(format = 'png') {
  if (!window.currentQRData) {
    alert('å…ˆã«QRã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„');
    return;
  }
  
  try {
    const { text, size, fgColor, bgColor, logoFile } = window.currentQRData;
    
    // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨Canvasç”Ÿæˆ
    const canvas = await SimpleQR.generateCanvas(text, {
      size: size,
      background: bgColor,
      errorCorrection: document.getElementById('qrErrorCorrection')?.value || 'M'
    });
    
    if (logoFile) {
      // ãƒ­ã‚´åˆæˆå‡¦ç†
      const ctx = canvas.getContext('2d');
      const reader = new FileReader();
      reader.onload = function(e) {
        const logoImg = new Image();
        logoImg.onload = function() {
          const logoSize = size * 0.22;
          const x = (size - logoSize) / 2;
          const y = (size - logoSize) / 2;
          
          // ãƒ­ã‚´èƒŒæ™¯ï¼ˆç™½ã„å††ï¼‰ã‚’æç”»
          ctx.fillStyle = bgColor;
          ctx.beginPath();
          ctx.arc(size/2, size/2, logoSize/2 + 5, 0, 2 * Math.PI);
          ctx.fill();
          
          ctx.drawImage(logoImg, x, y, logoSize, logoSize);
          
          // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ
          downloadCanvasAsFile(canvas, format);
        };
        logoImg.src = e.target.result;
      };
      reader.readAsDataURL(logoFile);
    } else {
      downloadCanvasAsFile(canvas, format);
    }
  } catch (error) {
    console.error('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error);
    alert('ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ');
  }
}

function downloadCanvasAsFile(canvas, format) {
  const mimeType = format === 'jpeg' ? 'image/jpeg' : 'image/png';
  const extension = format === 'jpeg' ? 'jpg' : format;
  
  canvas.toBlob(function(blob) {
    const filename = `qrcode_${Date.now()}.${extension}`;
    saveAs(blob, filename);
    showSuccess(`${format.toUpperCase()}ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ`);
  }, mimeType);
}

function showError(message) {
  const errorElement = document.getElementById('errorMessage');
  const statusElement = document.getElementById('statusMessage');
  const qrcodeOutput = document.getElementById('qrcodeOutput');
  
  // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
  if (errorElement) {
    errorElement.textContent = message;
    errorElement.classList.remove('hidden');
  }
  
  // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤º
  if (statusElement) {
    statusElement.classList.add('hidden');
  }
  
  // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ã«ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤º
  qrcodeOutput.innerHTML = `
    <div class="text-center">
      <svg class="w-12 h-12 text-red-400 mx-auto mb-3" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
      </svg>
      <span class="text-red-500 text-sm">${message}</span>
    </div>
  `;
  
  // 3ç§’å¾Œã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤º
  setTimeout(() => {
    if (errorElement) {
      errorElement.classList.add('hidden');
    }
  }, 5000);
}

function showSuccess(message) {
  const errorElement = document.getElementById('errorMessage');
  const statusElement = document.getElementById('statusMessage');
  
  // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
  if (statusElement) {
    statusElement.textContent = message;
    statusElement.classList.remove('hidden');
  }
  
  // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤º
  if (errorElement) {
    errorElement.classList.add('hidden');
  }
  
  // 3ç§’å¾Œã«æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤º
  setTimeout(() => {
    if (statusElement) {
      statusElement.classList.add('hidden');
    }
  }, 3000);
}

function setupDownloadButtons() {
  const downloadBtn = document.getElementById('downloadQrButton');
  const downloadSvgBtn = document.getElementById('downloadQrSvgButton');
  const downloadJpegBtn = document.getElementById('downloadQrJpegButton');
  
  if (downloadBtn) {
    downloadBtn.onclick = () => downloadQRCode('png');
  }
  
  if (downloadJpegBtn) {
    downloadJpegBtn.onclick = () => downloadQRCode('jpeg');
  }
  
  if (downloadSvgBtn) {
    downloadSvgBtn.onclick = () => {
      // SVGã¯ä»£æ›¿ã¨ã—ã¦PNGã‚’æä¾›
      downloadQRCode('png');
      
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥
      const statusMessage = document.getElementById('statusMessage');
      if (statusMessage) {
        statusMessage.textContent = 'SVGã¯ç¾åœ¨PNGå½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™';
        setTimeout(() => statusMessage.textContent = '', 3000);
      }
    };
  }
}

document.addEventListener('DOMContentLoaded', function() {
  console.log('DOMèª­ã¿è¾¼ã¿å®Œäº†');
  
  setupGuideModal();
  setupQrTypeSwitcher();
  setupAdBannerToggleDisplay();
  setupQrPreview();
  renderQrHistory();
  
  // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®è¨­å®š
  setupDownloadButtons();
  
  // æ–°ã—ã„æ©Ÿèƒ½ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  setupTabs();
  setupColorControls();
  setupSizeControls();
  setupGradientControls();
  setupBatchGeneration();
  setupQrAnalysis();
  setupTemplates();
  setupGitHubIntegration();
  setupApiIntegration();
  setupDataImport();
  setupUrlShortener();
  setupYouTubeExtractor();
  setupWebhook();
  setupThemePresets();
  updateStats();
    // è‡ªä½œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ç¢ºèª
  if (typeof SimpleQR !== 'undefined') {
    console.log('SimpleQR ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿æˆåŠŸï¼ˆè‡ªä½œå®Ÿè£…ï¼‰');
  } else {
    console.error('SimpleQR ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã«å¤±æ•—');
  }
    const genBtn = document.getElementById('generateQrButton');
  if (genBtn) {
    genBtn.addEventListener('click', function(e) {
      e.preventDefault();
      console.log('ç”Ÿæˆãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯');
      
      const qrType = document.getElementById('qrType').value;
      const qrData = getQrDataByType();
      const size = parseInt(document.getElementById('qrSize').value) || 256;
      const fg = document.getElementById('qrFgColor').value;
      const bg = document.getElementById('qrBgColor').value;
      const logoFile = document.getElementById('qrLogo').files[0];
      const enableAds = document.getElementById('qrAdBannerToggle')?.checked || false;
      
      console.log('ç”Ÿæˆãƒ‡ãƒ¼ã‚¿:', {qrType, qrData, size, fg, bg});
      
      if (!qrData) {
        showError('ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }
      
      // QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚’å®Ÿè¡Œ
      generateQrCode(qrData, size, fg, bg, logoFile, enableAds);
      
      // å±¥æ­´ä¿å­˜
      saveQrHistory(qrType, qrData, {size, fg, bg});
      renderQrHistory();
      incrementStats();
      
      // Webhooké€ä¿¡ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ï¼‰
      if (document.getElementById('enableWebhook')?.checked) {
        console.log('Webhooké€ä¿¡ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒ­ã‚°ã®ã¿ï¼‰:', {type: qrType, data: qrData, timestamp: new Date().toISOString()});
      }
    });
  }
  
  // åˆæœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é…å»¶å®Ÿè¡Œ
  setTimeout(() => {
    console.log('åˆæœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿè¡Œ');
    updatePreview();
  }, 1000);
});

// ãƒ†ãƒ¼ãƒãƒ—ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½
function setupThemePresets() {
  const themeButtons = document.querySelectorAll('.theme-preset');
  
  themeButtons.forEach(button => {
    button.addEventListener('click', () => {
      const theme = button.dataset.theme;
      applyTheme(theme);
      updatePreview();
    });
  });
}

function applyTheme(theme) {
  const fgColorInput = document.getElementById('qrFgColor');
  const bgColorInput = document.getElementById('qrBgColor');
  const fgColorText = document.getElementById('qrFgColorText');
  const bgColorText = document.getElementById('qrBgColorText');
  
  const themes = {
    classic: { fg: '#000000', bg: '#ffffff' },
    modern: { fg: '#1f2937', bg: '#f3f4f6' },
    nature: { fg: '#065f46', bg: '#ecfdf5' },
    creative: { fg: '#7c3aed', bg: '#faf5ff' }
  };
  
  if (themes[theme]) {
    fgColorInput.value = themes[theme].fg;
    bgColorInput.value = themes[theme].bg;
    fgColorText.value = themes[theme].fg;
    bgColorText.value = themes[theme].bg;
  }
}

// æ‹¡å¼µã•ã‚ŒãŸQRã‚³ãƒ¼ãƒ‰ç”Ÿæˆæ©Ÿèƒ½ï¼ˆãƒ‡ã‚¶ã‚¤ãƒ³ã‚¿ãƒ–å¯¾å¿œï¼‰
function generateQrCodeAdvanced(text, options = {}) {
  const size = parseInt(document.getElementById('qrSize').value) || 256;
  const fg = document.getElementById('qrFgColor').value || '#000000';
  const bg = document.getElementById('qrBgColor').value || '#ffffff';
  const pattern = document.querySelector('input[name="qrPattern"]:checked')?.value || 'square';
  const frame = document.getElementById('qrFrame')?.value || 'none';
  const enableGradient = document.getElementById('enableGradient')?.checked || false;
  const logoFile = document.getElementById('qrLogo').files[0];
  
  // QRiousã‚’ä½¿ç”¨ã—ãŸåŸºæœ¬ç”Ÿæˆ
  const canvas = document.createElement('canvas');
  const qr = new QRious({
    element: canvas,
    value: text,
    size: size,
    foreground: fg,
    background: bg,
    level: 'H'
  });
  
  const ctx = canvas.getContext('2d');
  
  // é«˜åº¦ãªã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°é©ç”¨
  if (enableGradient) {
    applyGradientEffect(ctx, canvas);
  }
  
  if (pattern !== 'square') {
    applyPatternEffect(ctx, canvas, pattern);
  }
  
  if (frame !== 'none') {
    applyFrameEffect(ctx, canvas, frame);
  }
  
  // ãƒ­ã‚´åˆæˆï¼ˆéåŒæœŸï¼‰
  if (logoFile) {
    return new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        const img = new Image();
        img.onload = () => {
          applyLogoToCanvas(ctx, img, canvas);
          resolve(canvas);
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(logoFile);
    });
  }
  
  return Promise.resolve(canvas);
}

function applyGradientEffect(ctx, canvas) {
  const startColor = document.getElementById('gradientStart')?.value || '#000000';
  const endColor = document.getElementById('gradientEnd')?.value || '#666666';
  const direction = document.getElementById('gradientDirection')?.value || 'linear';
  
  let gradient;
  if (direction === 'radial') {
    gradient = ctx.createRadialGradient(canvas.width/2, canvas.height/2, 0, canvas.width/2, canvas.height/2, canvas.width/2);
  } else {
    gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
  }
  
  gradient.addColorStop(0, startColor);
  gradient.addColorStop(1, endColor);
  
  ctx.globalCompositeOperation = 'multiply';
  ctx.fillStyle = gradient;
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.globalCompositeOperation = 'source-over';
}

function applyPatternEffect(ctx, canvas, pattern) {
  // ãƒ‘ã‚¿ãƒ¼ãƒ³åŠ¹æœã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡æ˜“ç‰ˆï¼‰
  if (pattern === 'circle') {
    // å††å½¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…ã¯è¤‡é›‘ãªãŸã‚ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã®ã¿
    console.log('Circle pattern applied');
  } else if (pattern === 'rounded') {
    // è§’ä¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…
    console.log('Rounded pattern applied');
  }
}

function applyFrameEffect(ctx, canvas, frame) {
  const padding = 20;
  
  switch(frame) {
    case 'simple':
      ctx.strokeStyle = '#000000';
      ctx.lineWidth = 2;
      ctx.strokeRect(padding, padding, canvas.width - padding*2, canvas.height - padding*2);
      break;
    case 'rounded':
      roundRect(ctx, padding, padding, canvas.width - padding*2, canvas.height - padding*2, 10);
      break;
    case 'shadow':
      ctx.shadowColor = 'rgba(0,0,0,0.3)';
      ctx.shadowBlur = 10;
      ctx.shadowOffsetX = 5;
      ctx.shadowOffsetY = 5;
      ctx.strokeRect(padding, padding, canvas.width - padding*2, canvas.height - padding*2);
      break;
  }
}

function roundRect(ctx, x, y, width, height, radius) {
  ctx.beginPath();
  ctx.moveTo(x + radius, y);
  ctx.lineTo(x + width - radius, y);
  ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
  ctx.lineTo(x + width, y + height - radius);
  ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
  ctx.lineTo(x + radius, y + height);
  ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
  ctx.lineTo(x, y + radius);
  ctx.quadraticCurveTo(x, y, x + radius, y);
  ctx.closePath();
  ctx.stroke();
}

function applyLogoToCanvas(ctx, logoImg, canvas) {
  const logoSizePercent = parseInt(document.getElementById('logoSize')?.value || 20);
  const logoBorder = document.getElementById('logoBorder')?.checked || false;
  const logoShadow = document.getElementById('logoShadow')?.checked || false;
  
  const logoSize = (canvas.width * logoSizePercent) / 100;
  const x = (canvas.width - logoSize) / 2;
  const y = (canvas.height - logoSize) / 2;
  
  // å½±åŠ¹æœ
  if (logoShadow) {
    ctx.shadowColor = 'rgba(0,0,0,0.5)';
    ctx.shadowBlur = 5;
    ctx.shadowOffsetX = 2;
    ctx.shadowOffsetY = 2;
  }
  
  // ç™½ã„ç¸å–ã‚Š
  if (logoBorder) {
    ctx.fillStyle = '#ffffff';
    ctx.beginPath();
    ctx.arc(canvas.width/2, canvas.height/2, logoSize/2 + 5, 0, 2 * Math.PI);
    ctx.fill();
  }
  
  // ãƒ­ã‚´æç”»
  ctx.drawImage(logoImg, x, y, logoSize, logoSize);
  
  // å½±åŠ¹æœãƒªã‚»ãƒƒãƒˆ
  ctx.shadowColor = 'transparent';
  ctx.shadowBlur = 0;
  ctx.shadowOffsetX = 0;
  ctx.shadowOffsetY = 0;
}
</script>
</body>
</html>
