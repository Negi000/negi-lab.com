<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self'; 
    script-src 'self' 'unsafe-inline' 'unsafe-eval' 
      https://cdn.tailwindcss.com; 
    style-src 'self' 'unsafe-inline' 
      https://fonts.googleapis.com 
      https://cdn.tailwindcss.com; 
    font-src 'self' 
      https://fonts.gstatic.com; 
    img-src 'self' data: blob:; 
    connect-src 'self'; 
    object-src 'none'; 
    base-uri 'self';
  " />
  
  <!-- Security Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
  <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <title data-translate-key="imageConverter.pageTitle">【無料】画像変換ツール - JPEG・PNG・WebP形式変換・リサイズ | negi-lab.com</title>
  <meta name="description" data-translate-key="imageConverter.metaDescription" content="画像をJPEG・PNG・WebP形式に高品質で変換できる無料ツール。品質調整やサイズ変更機能も搭載し、ブラウザ完結で安全に画像処理が可能です。Webデザインや画像最適化に最適な専門ツールです。" />
  <meta property="og:title" content="【無料】画像変換ツール - JPEG・PNG・WebP形式変換・リサイズ | negi-lab.com" />
  <meta property="og:description" content="画像をJPEG、PNG、WebP形式に無料で変換。品質調整やサイズ変更も可能。ブラウザ完結で安全・簡単に画像フォーマットを変換できるオンラインツール。" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://negi-lab.com/tools/image-converter.html" />
  <meta name="robots" content="index,follow" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" crossorigin="anonymous" />
  <script src="https://cdn.tailwindcss.com"></script>
    <!-- Security and Common Utilities -->
  <script src="/js/security-utils.js"></script>
  <script src="/js/common-utils.js"></script>
  
  <!-- Tailwind Configuration -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            negi: "#65c155",
            accent: "#4ADE80"
          },
          fontFamily: { inter: ["Inter", "sans-serif"] }
        }
      }
    }
    window.pageTitleTranslationKey = "imageConverter.pageTitle";
    window.metaDescriptionTranslationKey = "imageConverter.metaDescription";
  </script>
  <style>
    .form-select, .form-input, .form-button, .form-range {
      padding: 0.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      transition: box-shadow 0.2s;
    }
    .form-select:focus, .form-input:focus, .form-button:focus, .form-range:focus {
      outline: none;
      box-shadow: 0 0 0 2px #4ADE80;
      border-color: #4ADE80;
    }
    .form-button {
      background: #4ADE80;
      color: #fff;
      transition: background 0.15s, color 0.15s;
    }
    .form-button:hover:not(:disabled) {
      background: #10b981;
    }
    .form-button:disabled {
      background: #d1d5db;
      color: #fff;
      cursor: not-allowed;
    }
    .drop-area {
      border: 2px dashed #d1d5db;
      border-radius: 0.5rem;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: border-color 0.15s, background 0.15s;
    }
    .drop-area.dragover {
      border-color: #4ADE80;
      background: rgba(74, 222, 128, 0.1);
    }
    .preview-image {
      max-width: 100%;
      max-height: 16rem;
      border-radius: 0.375rem;
      border: 1px solid #e5e7eb;
      box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    }
  </style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1835873052239386" crossorigin="anonymous"></script>
</head>
<body class="bg-gray-50 text-gray-800 font-inter min-h-screen flex flex-col">

  <!-- Google Analytics（gtag.js）全ページ用 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-N9X3N0RY0H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N9X3N0RY0H');
  </script>

  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex justify-between items-center px-4 py-4">
      <a href="/" class="text-2xl font-extrabold text-accent tracking-tight hover:opacity-80 transition">negi-lab.com</a>
      <nav>
        <ul class="flex gap-6 font-medium text-base items-center">
          <li><a href="/#tools" class="hover:text-accent transition" data-translate-key="header.nav.tools">ツール</a></li>
          <li><a href="/#wikis" class="hover:text-accent transition" data-translate-key="header.nav.wikis">ゲームWiki</a></li>
          <li>
            <select id="lang-switch" class="rounded border border-gray-300 px-2 py-1 text-gray-700 text-sm focus:outline-none focus:ring-2 focus:ring-accent transition">
              <option value="ja" data-translate-key="option.ja">日本語</option>
              <option value="en" data-translate-key="option.en">English</option>
            </select>
          </li>
          <li>
            <button id="guide-btn" class="rounded border border-accent px-3 py-1 text-accent text-sm font-semibold bg-white hover:bg-accent/10 focus:outline-none focus:ring-2 focus:ring-accent transition" aria-haspopup="dialog" aria-controls="guide-modal" data-translate-key="header.guide">ガイド</button>
          </li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- ブレッドクラムナビゲーション -->
  <nav class="bg-gray-100 border-b border-gray-200" aria-label="ページナビゲーション">
    <div class="max-w-7xl mx-auto px-4 py-3">
      <ol class="flex items-center space-x-2 text-sm text-gray-600">
        <li><a href="/" class="text-accent hover:underline">ホーム</a></li>
        <li><span class="text-gray-400">/</span></li>
        <li><a href="/#tools" class="text-accent hover:underline">ツール</a></li>
        <li><span class="text-gray-400">/</span></li>
        <li class="text-gray-800 font-medium" aria-current="page">画像変換ツール</li>
      </ol>
    </div>
  </nav>

  <main class="flex-grow py-12">
    <div class="container mx-auto px-4 max-w-6xl">
      <div class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4" data-translate-key="imageConverter.mainTitle">画像変換ツール</h1>
      </div>
      
      <!-- ツール上部：アドセンス（レスポンシブ） -->
      <div class="max-w-2xl mx-auto my-6">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-1835873052239386"
             data-ad-slot="2847561903"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>

      <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg space-y-6">
        <div>
          <label for="imageUploadArea" class="block text-sm font-medium text-gray-700 mb-1" data-translate-key="imageConverter.uploadLabel">画像ファイルをアップロード:</label>
          <div id="imageUploadArea" class="drop-area" aria-label="画像ファイルアップロードエリア">
            <input type="file" id="imageFile" accept="image/jpeg, image/png, image/webp, image/gif" class="hidden" aria-describedby="fileHelp">
            <p id="dropInstructions" data-translate-html-key="imageConverter.dropInstructions" aria-label="ファイルのドラッグ＆ドロップまたはクリックして選択">ここにファイルをドラッグ＆ドロップ<br>またはクリックして選択</p>
          </div>
          <p id="fileName" class="text-sm text-gray-500 mt-1" aria-label="選択されたファイル名"></p>
        </div>

        <div id="previewContainer" class="mt-4 text-center hidden" aria-hidden="true">
            <img id="imagePreview" src="#" alt="Image Preview" class="preview-image inline-block" data-translate-key-alt="imageConverter.previewAlt" aria-label="アップロードされた画像のプレビュー"/>
        </div>

        <div>
          <label for="outputFormat" class="block text-sm font-medium text-gray-700 mb-1" data-translate-key="imageConverter.outputFormatLabel">出力フォーマット:</label>
          <select id="outputFormat" class="form-select w-full" aria-label="出力フォーマット選択">
            <option value="image/jpeg" data-translate-key="imageConverter.formatJPEG">JPEG</option>
            <option value="image/png" data-translate-key="imageConverter.formatPNG">PNG</option>
            <option value="image/webp" data-translate-key="imageConverter.formatWebP">WebP</option>
          </select>
        </div>

        <div id="qualityControlContainer" class="hidden" aria-hidden="true">
            <label for="qualityRange" class="block text-sm font-medium text-gray-700 mb-1" data-translate-key="imageConverter.qualityLabel">品質 (JPEG/WebP):</label>
            <div class="flex items-center gap-2">
                <input type="range" id="qualityRange" min="0.1" max="1" step="0.05" value="0.9" class="form-range w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" aria-label="画像品質調整">
                <span id="qualityValue" class="text-sm text-gray-600 w-10 text-right" aria-label="現在の品質値">0.90</span>
            </div>
        </div>
        
        <div>
            <p class="block text-sm font-medium text-gray-700 mb-1" data-translate-key="imageConverter.maxDimensionsLabel">最大寸法 (任意):</p>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label for="maxWidthInput" class="block text-xs font-medium text-gray-600" data-translate-key="imageConverter.maxWidthLabel">最大幅 (px):</label>
                    <input type="number" id="maxWidthInput" min="1" class="form-input w-full mt-1" placeholder="例: 1920" aria-label="最大幅入力フィールド">
                </div>
                <div>
                    <label for="maxHeightInput" class="block text-xs font-medium text-gray-600" data-translate-key="imageConverter.maxHeightLabel">最大高さ (px):</label>
                    <input type="number" id="maxHeightInput" min="1" class="form-input w-full mt-1" placeholder="例: 1080" aria-label="最大高さ入力フィールド">
                </div>
            </div>
        </div>
        
        <button id="convertButton" class="form-button w-full py-2.5" disabled data-translate-key="imageConverter.convertButton" aria-label="画像変換実行ボタン">変換する</button>
        
        <div id="resultContainer" class="mt-4 text-center hidden space-y-3" aria-hidden="true">
            <h3 class="text-lg font-medium text-gray-800" data-translate-key="unitConverter.resultLabel">結果:</h3>
            <img id="convertedImagePreview" src="#" alt="Converted Image Preview" class="preview-image inline-block" data-translate-key-alt="imageConverter.previewAlt" aria-label="変換後画像のプレビュー"/>
            <a id="downloadLink" href="#" download="converted_image.png" class="form-button inline-block py-2 px-4" data-translate-key="imageConverter.downloadButton" aria-label="変換後画像ダウンロードリンク">ダウンロード</a>
        </div>

        <div id="messageArea" class="text-sm mt-2">
            <p id="statusMessage" class="text-gray-600"></p>
            <p id="errorMessage" class="text-red-600"></p>
        </div>

      </div>

      <!-- スポンサーリンクラベル（広告直前） -->
      <div class="text-xs text-gray-500 mb-1" aria-label="スポンサーリンク">スポンサーリンク</div>
      <!-- ここに広告コード（例: AdSense）を挿入 -->

      <!-- ツール下部：Amazon・楽天バナー → ネイティブ/モーションウィジェット動的表示に置換 -->
      <div id="smart-ads" class="flex justify-center my-8"></div>
      <script>
        document.addEventListener('DOMContentLoaded', function() {
          if (window.renderSmartAds) window.renderSmartAds('smart-ads');
        });
      </script>

    </div>
  </main>

  <!-- 技術解説・活用ガイドセクション -->
  <section class="bg-gradient-to-br from-blue-50 to-green-50 py-16">
    <div class="container mx-auto px-4 max-w-6xl">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">画像変換活用完全ガイド</h2>
        <p class="text-gray-600 text-lg max-w-3xl mx-auto">
          Webデザインからコンテンツ制作まで、画像変換・最適化を効果的に活用するための実践的なノウハウをご紹介します。
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <!-- Web・デジタル活用事例 -->
        <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow">
          <div class="flex items-center mb-4">
            <div class="bg-blue-100 p-3 rounded-lg mr-4">
              <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-gray-800">Web・アプリ開発</h3>
          </div>
          <ul class="space-y-3 text-gray-600">
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>レスポンシブ対応：</strong>デバイス別最適化でUX向上</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>Core Web Vitals改善：</strong>LCP指標向上でSEO効果</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>WebP活用：</strong>次世代フォーマットで高圧縮</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>軽量化：</strong>ページ読み込み速度30-50%向上</span>
            </li>
          </ul>
        </div>

        <!-- コンテンツ制作・マーケティング -->
        <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow">
          <div class="flex items-center mb-4">
            <div class="bg-purple-100 p-3 rounded-lg mr-4">
              <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-gray-800">コンテンツ制作・SNS</h3>
          </div>
          <ul class="space-y-3 text-gray-600">
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>SNS最適化：</strong>プラットフォーム別サイズ制限対応</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>広告素材軽量化：</strong>表示速度でCTR向上</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>品質調整：</strong>用途に応じた最適バランス</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>一括処理：</strong>大量画像の効率的変換</span>
            </li>
          </ul>
        </div>

        <!-- ビジネス・業務効率化 -->
        <div class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow">
          <div class="flex items-center mb-4">
            <div class="bg-green-100 p-3 rounded-lg mr-4">
              <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
              </svg>
            </div>
            <h3 class="text-xl font-semibold text-gray-800">ビジネス・業務効率化</h3>
          </div>
          <ul class="space-y-3 text-gray-600">
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>Eコマース：</strong>商品画像統一でシステム効率化</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>印刷・DTP：</strong>高品質設定で印刷対応</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>ストレージ削減：</strong>容量最適化でコスト削減</span>
            </li>
            <li class="flex items-start">
              <span class="text-green-500 mr-2">✓</span>
              <span><strong>セキュリティ：</strong>ローカル処理で機密性確保</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- 技術解説セクション -->
  <section class="bg-white py-16">
    <div class="container mx-auto px-4 max-w-6xl">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">画像フォーマット技術の詳細解説</h2>
        <p class="text-gray-600 text-lg max-w-3xl mx-auto">
          各画像フォーマットの特性を理解することで、用途に最適な変換設定を選択できます。
        </p>
      </div>

      <div class="grid md:grid-cols-2 gap-12">
        <div>
          <h3 class="text-2xl font-semibold mb-6 text-gray-800">フォーマット別特性と使い分け</h3>
          <div class="space-y-4">
            <div class="border-l-4 border-red-400 pl-4 py-2">
              <h4 class="font-medium text-lg">JPEG - 写真・グラデーション向け</h4>
              <p class="text-sm text-gray-600">非可逆圧縮で小ファイルサイズ。写真系画像に最適。</p>
            </div>
            <div class="border-l-4 border-yellow-400 pl-4 py-2">
              <h4 class="font-medium text-lg">PNG - ロゴ・透明度対応</h4>
              <p class="text-sm text-gray-600">可逆圧縮で高品質。透明度・シャープエッジに最適。</p>
            </div>
            <div class="border-l-4 border-blue-400 pl-4 py-2">
              <h4 class="font-medium text-lg">WebP - 次世代最適化</h4>
              <p class="text-sm text-gray-600">JPEG比30-50%小。モダンブラウザで高圧縮。</p>
            </div>
            <div class="border-l-4 border-green-400 pl-4 py-2">
              <h4 class="font-medium text-lg">品質設定の指針</h4>
              <p class="text-sm text-gray-600">用途別最適値：Web 70-85%、印刷 90-95%、SNS 60-75%。</p>
            </div>
          </div>
        </div>
        
        <div>
          <h3 class="text-2xl font-semibold mb-6 text-gray-800">技術仕様と処理方式</h3>
          <div class="space-y-6">
            <div>
              <h4 class="font-medium mb-2 text-lg">Canvas API活用</h4>
              <p class="text-sm text-gray-600 mb-3">
                HTML5 Canvas要素を使用したブラウザ内高品質画像処理。色空間保持とピクセル精度を維持。
              </p>
              <div class="bg-blue-50 p-3 rounded-lg text-xs">
                <strong>利点：</strong> サーバー送信不要、リアルタイム処理、プライバシー保護
              </div>
            </div>
            
            <div>
              <h4 class="font-medium mb-2 text-lg">色空間・画質保持</h4>
              <p class="text-sm text-gray-600 mb-3">
                sRGB色空間の維持により、デバイス間での色再現性を確保。ICC プロファイル対応で印刷品質も保証。
              </p>
              <div class="bg-amber-50 p-3 rounded-lg text-xs">
                <strong>技術：</strong> sRGB維持、ICC対応、ガンマ補正適用
              </div>
            </div>
            
            <div>
              <h4 class="font-medium mb-2 text-lg">セキュリティ・プライバシー</h4>
              <p class="text-sm text-gray-600 mb-3">
                完全クライアントサイド処理により、機密画像も安全に変換。画像データのサーバー送信は一切なし。
              </p>
              <div class="bg-green-50 p-3 rounded-lg text-xs">
                <strong>保証：</strong> ローカル処理、データ非送信、即座削除
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ・トラブルシューティングセクション -->
  <section class="bg-gray-50 py-16">
    <div class="container mx-auto px-4 max-w-6xl">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">よくある質問・トラブルシューティング</h2>
        <p class="text-gray-600 text-lg max-w-3xl mx-auto">
          画像変換・最適化時によくある疑問や問題の解決方法をまとめました。
        </p>
      </div>

      <div class="space-y-6">
        <details class="bg-white border border-gray-200 rounded-lg p-6 cursor-pointer hover:bg-gray-50">
          <summary class="font-semibold text-lg text-gray-800 flex items-center justify-between">
            <span>どの画像フォーマットを選ぶべきですか？</span>
            <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="mt-4 space-y-4">
            <p class="text-gray-700 mb-3"><strong>用途別推奨フォーマット：</strong></p>
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <h4 class="font-medium text-blue-600 mb-2">写真・リアル系画像</h4>
                <ul class="text-sm text-gray-600 space-y-1">
                  <li>• <strong>JPEG（品質80-90%）：</strong>一般的なWeb用途</li>
                  <li>• <strong>WebP（品質75-85%）：</strong>モダンブラウザ最適化</li>
                  <li>• <strong>JPEG（品質90-95%）：</strong>印刷・高品質用途</li>
                  <li>• <strong>SNS投稿：</strong>ファイルサイズ制限に応じて調整</li>
                </ul>
              </div>
              <div>
                <h4 class="font-medium text-purple-600 mb-2">ロゴ・イラスト・アイコン</h4>
                <ul class="text-sm text-gray-600 space-y-1">
                  <li>• <strong>PNG：</strong>透明度が必要な場合</li>
                  <li>• <strong>WebP：</strong>透明度対応＋軽量化</li>
                  <li>• <strong>JPEG（高品質）：</strong>透明度不要な場合</li>
                  <li>• <strong>SVG：</strong>ベクターデータが利用可能な場合</li>
                </ul>
              </div>
            </div>
          </div>
        </details>
        
        <details class="bg-white border border-gray-200 rounded-lg p-6 cursor-pointer hover:bg-gray-50">
          <summary class="font-semibold text-lg text-gray-800 flex items-center justify-between">
            <span>品質設定の適切な値は？</span>
            <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="mt-4 space-y-4">
            <p class="text-gray-700 mb-3"><strong>用途別品質設定の目安：</strong></p>
            <div class="grid md:grid-cols-2 gap-6">
              <div>
                <h4 class="font-medium text-green-600 mb-3">推奨品質設定</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li><strong>Web一般用途：</strong>JPEG 70-85%（バランス重視）</li>
                  <li><strong>印刷・出版：</strong>JPEG 90-95%（高品質優先）</li>
                  <li><strong>SNS投稿：</strong>JPEG 60-75%（サイズ制限対応）</li>
                  <li><strong>WebP：</strong>同等品質でJPEG比20-30%削減</li>
                </ul>
              </div>
              <div>
                <h4 class="font-medium text-orange-600 mb-3">品質判断のポイント</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li><strong>圧縮アーティファクト：</strong>ブロックノイズの有無確認</li>
                  <li><strong>文字・エッジ：</strong>シャープさの保持度合い</li>
                  <li><strong>グラデーション：</strong>バンディング現象の回避</li>
                  <li><strong>ファイルサイズ：</strong>目標サイズとのバランス</li>
                </ul>
              </div>
            </div>
          </div>
        </details>
        
        <details class="bg-white border border-gray-200 rounded-lg p-6 cursor-pointer hover:bg-gray-50">
          <summary class="font-semibold text-lg text-gray-800 flex items-center justify-between">
            <span>変換後に画質が劣化する場合の対処法は？</span>
            <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="mt-4 space-y-4">
            <div class="bg-amber-50 border-l-4 border-amber-400 p-4 mb-4">
              <p class="text-amber-800 text-sm font-medium">
                ⚠️ 画質劣化は主に圧縮設定や元画像の特性に起因します。
              </p>
            </div>
            <div class="grid md:grid-cols-2 gap-6">
              <div>
                <h4 class="font-medium text-red-600 mb-3">劣化原因と対策</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li>• <strong>品質設定が低い：</strong>80%以上に上げて再変換</li>
                  <li>• <strong>フォーマット不適切：</strong>PNG→JPEG等の見直し</li>
                  <li>• <strong>重複圧縮：</strong>元画像が既に圧縮済みの場合</li>
                  <li>• <strong>解像度不足：</strong>元画像のサイズ確認</li>
                </ul>
              </div>
              <div>
                <h4 class="font-medium text-blue-600 mb-3">品質向上の方法</h4>
                <ul class="text-sm text-gray-600 space-y-2">
                  <li>• <strong>PNG形式：</strong>可逆圧縮で最高品質</li>
                  <li>• <strong>WebP可逆：</strong>PNG代替で軽量化</li>
                  <li>• <strong>JPEG高品質：</strong>90-95%設定</li>
                  <li>• <strong>元画像改善：</strong>高解像度素材の使用</li>
                </ul>
              </div>
            </div>
          </div>
        </details>
        
        <details class="bg-white border border-gray-200 rounded-lg p-6 cursor-pointer hover:bg-gray-50">
          <summary class="font-semibold text-lg text-gray-800 flex items-center justify-between">
            <span>大容量ファイルの処理が遅い・失敗する場合は？</span>
            <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </summary>
          <div class="mt-4 space-y-4">
            <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-4">
              <p class="text-green-800 text-sm font-medium">
                ✅ ブラウザメモリ制限に配慮した処理で効率的な変換が可能です。
              </p>
            </div>
            <div class="space-y-4">
              <div>
                <h4 class="font-medium text-gray-800 mb-2">推奨処理サイズと方法</h4>
                <ul class="text-sm text-gray-600 space-y-1 ml-4">
                  <li>• <strong>推奨上限：</strong>10MP（約3000×3000px）程度</li>
                  <li>• <strong>事前リサイズ：</strong>用途に応じた適切サイズに調整</li>
                  <li>• <strong>分割処理：</strong>複数ファイルを順次処理</li>
                  <li>• <strong>メモリ解放：</strong>処理後のブラウザリフレッシュ</li>
                </ul>
              </div>
              <div>
                <h4 class="font-medium text-gray-800 mb-2">パフォーマンス最適化</h4>
                <ul class="text-sm text-gray-600 space-y-1 ml-4">
                  <li>• <strong>ブラウザ選択：</strong>Chrome・Edge等の高性能ブラウザ</li>
                  <li>• <strong>他タブ閉鎖：</strong>メモリリソースの確保</li>
                  <li>• <strong>段階的変換：</strong>リサイズ→フォーマット変換の順序</li>
                  <li>• <strong>品質調整：</strong>処理負荷と品質のバランス</li>
                </ul>
              </div>
            </div>
          </div>
        </details>
      </div>
    </div>
  </section>

  <!-- 実用事例集セクション -->
  <section class="bg-white py-16">
    <div class="container mx-auto px-4 max-w-6xl">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">実際の活用事例</h2>
        <p class="text-gray-600 text-lg max-w-3xl mx-auto">
          様々な業界・用途での実際の画像変換・最適化活用事例をご紹介します。
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
          <div class="text-4xl mb-4">🌐</div>
          <h3 class="text-lg font-semibold mb-3">Webサイトの表示速度改善</h3>
          <p class="text-gray-600 text-sm mb-4">
            EC企業では、商品画像をWebP形式に一括変換。
            ページ読み込み時間40%短縮により、コンバージョン率15%向上を実現。
          </p>
          <div class="text-xs text-blue-600 bg-blue-50 p-2 rounded mb-2">
            使用機能: JPEG→WebP変換（品質80%）
          </div>
          <div class="text-xs text-gray-500">
            <strong>成果：</strong> 読み込み時間40%短縮 + CVR 15%向上
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
          <div class="text-4xl mb-4">📱</div>
          <h3 class="text-lg font-semibold mb-3">SNSマーケティングの効率化</h3>
          <p class="text-gray-600 text-sm mb-4">
            美容ブランドでは、Instagram投稿用に画像を自動最適化。
            各プラットフォームのサイズ制限に対応し、投稿作業時間70%削減。
          </p>
          <div class="text-xs text-green-600 bg-green-50 p-2 rounded mb-2">
            使用機能: サイズ調整 + JPEG品質70%
          </div>
          <div class="text-xs text-gray-500">
            <strong>成果：</strong> 投稿作業時間70%削減 + 品質統一
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
          <div class="text-4xl mb-4">🎨</div>
          <h3 class="text-lg font-semibold mb-3">デザイン制作の効率化</h3>
          <p class="text-gray-600 text-sm mb-4">
            広告代理店では、クライアント素材を統一フォーマットに変換。
            制作工程の標準化により、プロジェクト進行速度30%向上。
          </p>
          <div class="text-xs text-purple-600 bg-purple-50 p-2 rounded mb-2">
            使用機能: PNG→JPEG変換 + 品質統一
          </div>
          <div class="text-xs text-gray-500">
            <strong>成果：</strong> 制作速度30%向上 + 品質統一
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
          <div class="text-4xl mb-4">🏢</div>
          <h3 class="text-lg font-semibold mb-3">企業システムの容量最適化</h3>
          <p class="text-gray-600 text-sm mb-4">
            製造業では、技術資料の画像を高圧縮形式に変換。
            サーバー容量50%削減により、インフラコスト年間200万円削減。
          </p>
          <div class="text-xs text-red-600 bg-red-50 p-2 rounded mb-2">
            使用機能: PNG→WebP変換（品質85%）
          </div>
          <div class="text-xs text-gray-500">
            <strong>成果：</strong> 容量50%削減 + コスト200万円削減
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
          <div class="text-4xl mb-4">🖨️</div>
          <h3 class="text-lg font-semibold mb-3">印刷・出版業界での品質管理</h3>
          <p class="text-gray-600 text-sm mb-4">
            出版社では、Web用画像を印刷用高品質JPEGに変換。
            カタログ制作の自動化により、制作期間50%短縮を実現。
          </p>
          <div class="text-xs text-indigo-600 bg-indigo-50 p-2 rounded mb-2">
            使用機能: WebP→JPEG変換（品質95%）
          </div>
          <div class="text-xs text-gray-500">
            <strong>成果：</strong> 制作期間50%短縮 + 品質向上
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
          <div class="text-4xl mb-4">🔒</div>
          <h3 class="text-lg font-semibold mb-3">機密性重視の画像処理</h3>
          <p class="text-gray-600 text-sm mb-4">
            金融機関では、機密文書の画像をローカル変換。
            セキュリティを保ちながら効率的なデジタル化を実現。
          </p>
          <div class="text-xs text-teal-600 bg-teal-50 p-2 rounded mb-2">
            使用機能: ローカル処理 + PNG高品質変換
          </div>
          <div class="text-xs text-gray-500">
            <strong>成果：</strong> セキュリティ確保 + 業務効率化
          </div>
        </div>
      </div>

      <div class="mt-12 text-center">
        <div class="bg-accent/10 rounded-xl p-6 max-w-3xl mx-auto">
          <h3 class="text-lg font-semibold text-gray-800 mb-3">あなたの画像も最適化してみませんか？</h3>
          <p class="text-gray-600 text-sm mb-4">
            これらの事例を参考に、あなたの業界・用途に合わせた画像最適化を始めてみましょう。
            当ツールなら、すべての変換ニーズに対応した高品質な処理を安全に実行できます。
          </p>
          <a href="#" onclick="document.querySelector('.drop-area').scrollIntoView({behavior: 'smooth'}); return false;" 
             class="inline-block bg-accent hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
            今すぐ画像変換を始める
          </a>
        </div>
      </div>
    </div>
  </section>

  <section class="mt-12 mb-8 text-sm text-gray-700 bg-white rounded-lg p-4 border border-gray-200 max-w-xl mx-auto" aria-label="このツールについて">
    <h2 class="font-bold text-base mb-2">negi-lab.comの独自性・運営方針・免責事項</h2>
    <ul class="list-disc ml-5 mb-2">
      <li>本ツールはnegi-lab.comが独自開発・運営しています。</li>
      <li>広告・アフィリエイトを含みますが、ユーザー体験を最優先しています。</li>
      <li>正確性・安全性には万全を期していますが、利用は自己責任でお願いします。</li>
    </ul>
    <p class="text-xs text-gray-500">&copy; 2025 negi-lab.com</p>
  </section>

  <footer class="bg-gray-800 text-gray-300 py-8 text-center text-sm">
    <nav class="mb-2">
      <a href="/privacy-policy-unified.html" class="underline hover:text-accent mx-2">プライバシーポリシー</a>
      <a href="/terms.html" class="underline hover:text-accent mx-2">利用規約</a>
      <a href="/about.html" class="underline hover:text-accent mx-2">運営者情報</a>
      <a href="mailto:negilab.com@gmail.com" class="underline hover:text-accent mx-2">お問い合わせ</a>
      <a href="/sitemap.xml" class="underline hover:text-accent mx-2">サイトマップ</a>
    </nav>
    <div>&copy; 2025 negi-lab.com</div>
  </footer>

  <!-- Guide Modal Popup -->
  <div id="guide-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 hidden" role="dialog" aria-modal="true" aria-labelledby="guide-modal-title">
    <div class="bg-white rounded-xl shadow-xl max-w-lg w-full p-6 relative">
      <button id="guide-close" class="absolute top-2 right-2 text-gray-400 hover:text-accent text-2xl font-bold" aria-label="閉じる">&times;</button>
      <div id="guide-modal-content"></div>
    </div>
  </div>

  <script type="module" src="../index.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const imageFile = document.getElementById('imageFile');
        const imageUploadArea = document.getElementById('imageUploadArea');
        const dropInstructions = document.getElementById('dropInstructions');
        const fileNameDisplay = document.getElementById('fileName');
        const outputFormatSelect = document.getElementById('outputFormat');
        const qualityControlContainer = document.getElementById('qualityControlContainer');
        const qualityRange = document.getElementById('qualityRange');
        const qualityValue = document.getElementById('qualityValue');
        const maxWidthInput = document.getElementById('maxWidthInput');
        const maxHeightInput = document.getElementById('maxHeightInput');
        const convertButton = document.getElementById('convertButton');
        const imagePreview = document.getElementById('imagePreview');
        const previewContainer = document.getElementById('previewContainer');
        const convertedImagePreview = document.getElementById('convertedImagePreview');
        const downloadLink = document.getElementById('downloadLink');
        const resultContainer = document.getElementById('resultContainer');
        const statusMessage = document.getElementById('statusMessage');
        const errorMessage = document.getElementById('errorMessage');

        const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10 MB
        let currentFile = null;
        let originalFileName = 'image';

        function getLang() {
            return document.documentElement.lang || 'ja';
        }

        function translate(key, type = 'text') {
            const lang = getLang();
            if (window.translations && window.translations[lang] && window.translations[lang][key]) {
                return window.translations[lang][key];
            }
            // Fallbacks from provided translations or keys themselves
            const fallbacks = {
                'imageConverter.convertingMessage': 'Converting...',
                'imageConverter.noImageSelected': 'Please select an image to convert.',
                'imageConverter.error.fileType': 'Unsupported file type.',
                'imageConverter.error.generic': 'Conversion error.',
                'imageConverter.imageTooLarge': 'File is too large.',
                'imageConverter.error.invalidDimensions': 'Invalid dimensions. Please enter positive numbers.',
                'imageConverter.dropInstructions': "Drag & drop your file here<br>or click to select"
            };
            return fallbacks[key] || key;
        }
        
        function updateQualityVisibility() {
            const format = outputFormatSelect.value;
            if (format === 'image/jpeg' || format === 'image/webp') {
                qualityControlContainer.classList.remove('hidden');
            } else {
                qualityControlContainer.classList.add('hidden');
            }
        }

        outputFormatSelect.addEventListener('change', updateQualityVisibility);
        qualityRange.addEventListener('input', () => {
            qualityValue.textContent = parseFloat(qualityRange.value).toFixed(2);
        });


        imageUploadArea.addEventListener('click', () => imageFile.click());
        imageUploadArea.addEventListener('dragover', (event) => {
            event.preventDefault();
            imageUploadArea.classList.add('dragover');
        });
        imageUploadArea.addEventListener('dragleave', () => {
            imageUploadArea.classList.remove('dragover');
        });
        imageUploadArea.addEventListener('drop', (event) => {
            event.preventDefault();
            imageUploadArea.classList.remove('dragover');
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });        imageFile.addEventListener('change', (event) => {
            if (event.target.files.length > 0) {
                handleFile(event.target.files[0]);
            }
        });

        function handleFile(file) {
            clearMessages();
            resultContainer.classList.add('hidden');
            
            // セキュリティ強化されたファイル検証
            if (!SecurityUtils.validateFileSize(file, 10)) {
                SecurityUtils.showUserError('ファイルサイズが10MBを超えています');
                resetFileState();
                return;
            }

            const allowedTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];
            if (!SecurityUtils.validateFileType(file, allowedTypes)) {
                SecurityUtils.showUserError('サポートされていないファイル形式です（JPEG、PNG、WebP、GIFのみ）');
                resetFileState();
                return;
            }

            // ファイル名の検証とサニタイズ
            const fileName = SecurityUtils.sanitizeInput(file.name);
            if (!fileName) {
                SecurityUtils.showUserError('無効なファイル名です');
                resetFileState();
                return;
            }

            currentFile = file;
            originalFileName = fileName.substring(0, fileName.lastIndexOf('.')) || 'image';
            fileNameDisplay.textContent = fileName;
            dropInstructions.classList.add('hidden');
            
            // セキュアな画像プレビュー
            CommonUtils.previewImage(file, 'preview-container-inner');
            convertButton.disabled = false;
            
            SecurityUtils.showSuccessMessage(`ファイル "${fileName}" を読み込みました`);
        }
        
        function resetFileState() {
            currentFile = null;
            imageFile.value = ''; 
            fileNameDisplay.textContent = '';
            dropInstructions.classList.remove('hidden');
            previewContainer.classList.add('hidden');
            imagePreview.src = '#';
            convertButton.disabled = true;
            resultContainer.classList.add('hidden');
            maxWidthInput.value = '';
            maxHeightInput.value = '';
        }

        function clearMessages() {
            statusMessage.textContent = '';
            errorMessage.textContent = '';
        }        convertButton.addEventListener('click', async () => {
            if (!currentFile) {
                SecurityUtils.showUserError('画像ファイルが選択されていません');
                return;
            }
            
            clearMessages();
            CommonUtils.showLoading('status-message-area', '画像を変換中...');
            convertButton.disabled = true;
            resultContainer.classList.add('hidden');

            try {
                // 入力値検証
                const maxWidthValue = CommonUtils.getFormValue('maxWidth', false);
                const maxHeightValue = CommonUtils.getFormValue('maxHeight', false);
                
                const pMaxWidth = maxWidthValue ? parseInt(maxWidthValue) : 0;
                const pMaxHeight = maxHeightValue ? parseInt(maxHeightValue) : 0;

                // サイズ制限チェック
                if (pMaxWidth > 0 && (pMaxWidth < 1 || pMaxWidth > 10000)) {
                    SecurityUtils.showUserError('幅は1〜10000ピクセルの範囲で入力してください');
                    return;
                }
                
                if (pMaxHeight > 0 && (pMaxHeight < 1 || pMaxHeight > 10000)) {
                    SecurityUtils.showUserError('高さは1〜10000ピクセルの範囲で入力してください');
                    return;
                }

                const outputMimeType = SecurityUtils.sanitizeInput(outputFormatSelect.value);
                const allowedMimeTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];
                if (!allowedMimeTypes.includes(outputMimeType)) {
                    SecurityUtils.showUserError('無効な出力形式です');
                    return;
                }

                const result = await convertImage(currentFile, outputMimeType, pMaxWidth, pMaxHeight);
                processConversionResult(result, outputMimeType);
                
            } catch (error) {
                SecurityUtils.showUserError('画像変換に失敗しました', error);
            } finally {
                CommonUtils.hideLoading('status-message-area');
                convertButton.disabled = false;
            }
        });

        async function convertImage(file, outputMimeType, maxWidth, maxHeight) {
            return new Promise((resolve, reject) => {
                const image = new Image();
                const reader = new FileReader();

                reader.onload = (event) => {
                    image.onload = () => {
                        try {
                            const canvas = document.createElement('canvas');
                            let { naturalWidth: width, naturalHeight: height } = image;

                            // サイズ計算（セキュリティ考慮）
                            if (maxWidth > 0 || maxHeight > 0) {
                                if (maxWidth > 0 && maxHeight > 0) {
                                    const ratio = Math.min(maxWidth / width, maxHeight / height);
                                    width = Math.round(width * ratio);
                                    height = Math.round(height * ratio);
                                } else if (maxWidth > 0) {
                                    const ratio = maxWidth / width;
                                    width = maxWidth;
                                    height = Math.round(height * ratio);
                                } else if (maxHeight > 0) {
                                    const ratio = maxHeight / height;
                                    height = maxHeight;
                                    width = Math.round(width * ratio);
                                }
                            }
                            
                            // 最小サイズ保証
                            canvas.width = Math.max(width, 1);
                            canvas.height = Math.max(height, 1);

                            const ctx = canvas.getContext('2d');
                            
                            // GIFから他の形式への変換時は背景を白に
                            if (file.type === 'image/gif' && outputMimeType !== 'image/gif') {
                                ctx.fillStyle = '#FFFFFF';
                                ctx.fillRect(0, 0, canvas.width, canvas.height);
                            }
                            
                            ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

                            const quality = parseFloat(qualityRange.value);
                            
                            if (outputMimeType === 'image/png') {
                                canvas.toBlob(resolve, outputMimeType);
                            } else {
                                canvas.toBlob(resolve, outputMimeType, quality);
                            }
                            
                        } catch (error) {
                            reject(error);
                        }
                    };
                    
                    image.onerror = () => reject(new Error('画像の読み込みに失敗しました'));
                    image.src = event.target.result;
                };
                
                reader.onerror = () => reject(new Error('ファイルの読み込みに失敗しました'));
                reader.readAsDataURL(file);
            });
        }

        function processConversionResult(blob, mimeType) {
            if (!blob) {
                SecurityUtils.showUserError('画像変換に失敗しました');                return;
            }
            
            const convertedUrl = URL.createObjectURL(blob);
            convertedImagePreview.src = convertedUrl;
            
            const fileExtension = mimeType.split('/')[1];
            const sanitizedFileName = SecurityUtils.sanitizeInput(originalFileName);
            downloadLink.href = convertedUrl;
            downloadLink.download = `${sanitizedFileName}_converted.${fileExtension}`;
            
            resultContainer.classList.remove('hidden');
            SecurityUtils.showSuccessMessage('画像変換が完了しました');
        }
            
        // 言語切り替え監視
        const langSwitchObserver = new MutationObserver(() => {
            const dropText = translate('imageConverter.dropInstructions', 'html');
            if (dropInstructions.innerHTML !== dropText) {
                 dropInstructions.innerHTML = dropText;
            }
            // Re-translate error message if visible
            if (errorMessage.textContent) {
                const currentErrorKey = Object.keys(window.translations[getLang()] || {}).find(key => window.translations[getLang()][key] === errorMessage.textContent);
                if (currentErrorKey) errorMessage.textContent = translate(currentErrorKey);
            }
        });
        langSwitchObserver.observe(document.documentElement, { attributes: true, attributeFilter: ['lang'] });
        
        // 初期設定
        updateQualityVisibility();
        dropInstructions.innerHTML = translate('imageConverter.dropInstructions', 'html');
    });
  </script>
  <script>
    // ガイドモーダルの表示/非表示制御
    document.addEventListener('DOMContentLoaded', function() {
      const guideBtn = document.getElementById('guide-btn');
      const guideModal = document.getElementById('guide-modal');
      const guideClose = document.getElementById('guide-close');
      const guideContent = document.getElementById('guide-modal-content');
      // 多言語ガイドデータ
      const guides = {
        ja: {
          title: '画像変換ツールの使い方',
          list: [
            '画像ファイル（JPEG, PNG, WebP等）をアップロード',
            '出力形式や品質・サイズを選択',
            '変換ボタンを押すと新しい画像をダウンロード',
            '右上メニューで日本語・英語切替可能'
          ],
          tipsTitle: '活用例・ヒント',
          tips: [
            'PNG→JPEGでファイルサイズ削減',
            'SNSやWeb用に画像をリサイズ'
          ]
        },
        en: {
          title: 'How to Use the Image Converter',
          list: [
            'Upload an image file (JPEG, PNG, WebP, etc.).',
            'Select the output format and adjust quality/size if needed.',
            'Click the convert button to download the new image.',
            'Switch language from the top menu. All features are available in English and Japanese.'
          ],
          tipsTitle: 'Tips & Examples',
          tips: [
            'Convert PNG to JPEG to reduce file size.',
            'Resize images for social media or web use.'
          ]
        }
      };
      function renderGuide(lang) {
        const g = guides[lang] || guides.ja;
        let html = `<h2 class='text-xl font-bold mb-3'>${g.title}</h2>`;
        html += '<ul class="list-disc ml-5 mb-4 text-gray-700">' + g.list.map(x=>`<li>${x}</li>`).join('') + '</ul>';
        html += `<h3 class='font-bold text-base mt-6 mb-2'>${g.tipsTitle}</h3><ul class='list-disc ml-5 text-gray-700'>` + g.tips.map(x=>`<li>${x}</li>`).join('') + '</ul>';
        guideContent.innerHTML = html;
      }
      if(guideBtn && guideModal && guideClose && guideContent) {
        guideBtn.addEventListener('click', function() {
          const lang = document.documentElement.lang || localStorage.getItem('selectedLanguage') || 'ja';
          renderGuide(lang);
          guideModal.classList.remove('hidden');
        });
        guideClose.addEventListener('click', function() {
          guideModal.classList.add('hidden');
        });
        guideModal.addEventListener('click', function(e) {
          if(e.target === guideModal) guideModal.classList.add('hidden');
        });
      }
    });
  </script>

  
</body>
</html>

